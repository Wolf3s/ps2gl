<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PS2SDK: GS memory &#39;slots&#39;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PS2SDK
   </div>
   <div id="projectbrief">PS2 Homebrew Libraries</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">GS memory 'slots'<div class="ingroups"><a class="el" href="group__pgl__api.html">pgl* API</a> &raquo; <a class="el" href="group__gs__mem.html">gs memory management</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab8c35b45aa5aaf7bc84c3d87696f13bc"><td class="memItemLeft" align="right" valign="top">pgl_slot_handle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__gs__mem__slots.html#gab8c35b45aa5aaf7bc84c3d87696f13bc">pglAddGsMemSlot</a> (int startingPage, int pageLength, unsigned int pixelMode)</td></tr>
<tr class="separator:gab8c35b45aa5aaf7bc84c3d87696f13bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacfb16d5676a001f49d9c4d860e6112f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__gs__mem__slots.html#gacfb16d5676a001f49d9c4d860e6112f3">pglLockGsMemSlot</a> (pgl_slot_handle_t slot_handle)</td></tr>
<tr class="separator:gacfb16d5676a001f49d9c4d860e6112f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac13343490b8bdeca3311b17680a15380"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__gs__mem__slots.html#gac13343490b8bdeca3311b17680a15380">pglUnlockGsMemSlot</a> (pgl_slot_handle_t slot_handle)</td></tr>
<tr class="separator:gac13343490b8bdeca3311b17680a15380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47310b5954ac9b60a0e70cd84b948787"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__gs__mem__slots.html#ga47310b5954ac9b60a0e70cd84b948787">pglRemoveAllGsMemSlots</a> ()</td></tr>
<tr class="separator:ga47310b5954ac9b60a0e70cd84b948787"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>API for managing the "slots" that partition GS memory in ps2gl. As mentioned in the documentation for "GS memory management," ps2gl asks the user to partition GS memory into slots. A slot is defined by a starting page number in GS ram, a page length, and a preferred pixel format.</p>
<p>Note that the pixel format of a slot is its <em>preferred</em> format. If there are no slots of the requested pixel type large enough, ps2gl will try to find a big enough slot of a "higher" pixel type. For example, a 64x64, 32-bit slot (2 pages) might be allocated to hold a 128x128, 8-bit image if there were no 8-bit slots large enough.</p>
<p>The idea is that if a level has a lot of 64x64, 8-bit textures, you would allocate a lot of 64x64, 8-bit slots.</p>
<p>For example, say that our app uses a 640x448 interlaced display with a 24-bit depth buffer. We would create 3 slots, one for the depth buffer and two for a double-buffered frame buffer.</p>
<p>First, we need the size and starting address of each slot. The size is calculated from the dimensions of a page for the pixel format in question. Here are the dimensions of one GS "page" for the various pixel formats (from section 8.3 of the GS manual):</p>
<ul>
<li>64x32: PSMCT32/24, PSMZ32/24</li>
<li>64x64: PSMCT16/16S</li>
<li>128x64: PSMT8</li>
<li>128x128: PSMT4</li>
</ul>
<p>Each frame buffer is 640x224 (interlaced) at 32-bits. This means we need a slot 10 pages by 7 pages = 70 pages. The 24-bit depth buffer pages are the same size, so we need another 70 pages for the depth buffer.</p>
<p>Now that we have the sizes of each slot (70 pages), we just need the starting addresses. It doesn't really matter much where they begin, except of course when existing code assumes to find them in certain places. So let's make them contiguous starting at page 0: </p>
<p>pglAddGsMemSlot( 0, 70, SCE_GS_PSMCT32 );<br  />
 pglAddGsMemSlot( 70, 70, SCE_GS_PSMCT32 );<br  />
 pglAddGsMemSlot( 140, 70, SCE_GS_PSMZ32 );<br  />
 </p>
<p>Take a look at ps2glut.cpp for a more complete example (a better tutorial is on the way). </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gab8c35b45aa5aaf7bc84c3d87696f13bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab8c35b45aa5aaf7bc84c3d87696f13bc">&#9670;&nbsp;</a></span>pglAddGsMemSlot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pgl_slot_handle_t pglAddGsMemSlot </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>startingPage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>pixelMode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a memory slot to the list of free slots. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">startingPage</td><td>the first page this slot occupies </td></tr>
    <tr><td class="paramname">pageLength</td><td>the number of pages this slot occupies (NOT the last page) </td></tr>
    <tr><td class="paramname">pixelMode</td><td>the preferred pixel format of this slot </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a handle to the new slot </dd></dl>

</div>
</div>
<a id="gacfb16d5676a001f49d9c4d860e6112f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacfb16d5676a001f49d9c4d860e6112f3">&#9670;&nbsp;</a></span>pglLockGsMemSlot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pglLockGsMemSlot </td>
          <td>(</td>
          <td class="paramtype">pgl_slot_handle_t&#160;</td>
          <td class="paramname"><em>slot_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prevents a slot from being allocated or freed automatically. The slot can still be bound to an area by the user. </p>

</div>
</div>
<a id="ga47310b5954ac9b60a0e70cd84b948787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47310b5954ac9b60a0e70cd84b948787">&#9670;&nbsp;</a></span>pglRemoveAllGsMemSlots()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pglRemoveAllGsMemSlots </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes all gs memory slots. </p>

</div>
</div>
<a id="gac13343490b8bdeca3311b17680a15380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac13343490b8bdeca3311b17680a15380">&#9670;&nbsp;</a></span>pglUnlockGsMemSlot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pglUnlockGsMemSlot </td>
          <td>(</td>
          <td class="paramtype">pgl_slot_handle_t&#160;</td>
          <td class="paramname"><em>slot_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lets the memory manager automatically allocate/free a slot that was previously locked. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
