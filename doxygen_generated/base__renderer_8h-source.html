<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>base_renderer.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>base_renderer.h</h1><a href="base__renderer_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*        Copyright (C) 2000,2001,2002  Sony Computer Entertainment America</font>
00002           
00003           This file is subject to the terms and conditions of the GNU Lesser
00004           General Public License Version 2.1. See the file "COPYING" in the
00005           main directory of this archive for more details.                             */
00006 
00007 <font class="preprocessor">#ifndef ps2gl_base_renderer_h</font>
00008 <font class="preprocessor">#define ps2gl_base_renderer_h</font>
00009 
00010 <font class="preprocessor">#include "<a class="code" href="renderer_8h.html">ps2gl/renderer.h</a>"</font>
00011 
00012 <font class="preprocessor">#include "ps2s/cpu_vector.h"</font>
00013 <font class="preprocessor">#include "ps2s/gs.h"</font>
00014 
00015 <font class="comment">/********************************************</font>
00016  * code common to ps2gl's built-in renderers
00017  */
00018 
<a name="l00019"></a><a class="code" href="classCBaseRenderer.html">00019</a> <font class="keyword">class </font><a class="code" href="classCBaseRenderer.html">CBaseRenderer</a> : <font class="keyword">public</font> <a class="code" href="classCRenderer.html">CRenderer</a> {
00020    <font class="keyword">protected</font>:
00021       <font class="comment">// cache some state for use in DrawArrays</font>
<a name="l00022"></a><a class="code" href="classCBaseRenderer.html#n0">00022</a>       <font class="keywordtype">bool</font>              XferVertices, XferColors, XferNormals, XferTexCoords;
00023 
<a name="l00024"></a><a class="code" href="classCBaseRenderer.html#n4">00024</a>       <font class="keywordtype">bool</font>              VifDoubleBuffered;
00025 
00026       <font class="comment">// cached in DrawArrays from geometry manager for XferBlock</font>
<a name="l00027"></a><a class="code" href="classCBaseRenderer.html#n5">00027</a>       <font class="keywordtype">float</font>             CurTexCoord[2];
<a name="l00028"></a><a class="code" href="classCBaseRenderer.html#n6">00028</a>       cpu_vec_xyz       CurNormal;
<a name="l00029"></a><a class="code" href="classCBaseRenderer.html#n7">00029</a>       CDmaPacket        *TexCoordBuf, *NormalBuf;
00030 
<a name="l00031"></a><a class="code" href="classCBaseRenderer.html#n9">00031</a>       <font class="keywordtype">int</font>               WordsPerVertex, WordsPerNormal, WordsPerTexCoord, WordsPerColor;
<a name="l00032"></a><a class="code" href="classCBaseRenderer.html#n13">00032</a>       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>      VertexUnpackMode, NormalUnpackMode;
<a name="l00033"></a><a class="code" href="classCBaseRenderer.html#n15">00033</a>       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>      TexCoordUnpackMode, ColorUnpackMode;
<a name="l00034"></a><a class="code" href="classCBaseRenderer.html#n17">00034</a>       Vifs::tMask       VertexUnpackMask, NormalUnpackMask;
<a name="l00035"></a><a class="code" href="classCBaseRenderer.html#n19">00035</a>       Vifs::tMask       TexCoordUnpackMask, ColorUnpackMask;
00036 
<a name="l00037"></a><a class="code" href="classCBaseRenderer.html#n22">00037</a>       <font class="keywordtype">int</font>               InputQuadsPerVert, OutputQuadsPerVert;
<a name="l00038"></a><a class="code" href="classCBaseRenderer.html#n23">00038</a>       <font class="keywordtype">int</font>               InputGeomOffset;
00039 
<a name="l00040"></a><a class="code" href="classCBaseRenderer.html#n24">00040</a>       <font class="keywordtype">void</font>              *MicrocodePacket;
00041 
<a name="l00042"></a><a class="code" href="classCBaseRenderer.html#n25">00042</a>       <font class="keyword">const</font> <font class="keywordtype">char</font>        *Name;
00043 
<a name="l00044"></a><a class="code" href="classCBaseRenderer.html#b0">00044</a>       <a class="code" href="classCBaseRenderer.html#b0">CBaseRenderer</a>( <font class="keywordtype">void</font> *packet,
00045                      <font class="keywordtype">int</font> inQuadsPerVert, <font class="keywordtype">int</font> outQuadsPerVert,
00046                      <font class="keywordtype">int</font> inGeomOffset, <font class="keyword">const</font> <font class="keywordtype">char</font> *name)
00047          : XferVertices(true), VifDoubleBuffered(true),
00048            WordsPerVertex(0), WordsPerNormal(0), WordsPerTexCoord(0), WordsPerColor(0),
00049            InputQuadsPerVert(inQuadsPerVert), OutputQuadsPerVert(outQuadsPerVert),
00050            InputGeomOffset(inGeomOffset),
00051            MicrocodePacket(packet),
00052            Name(name)
00053       {}
00054 
<a name="l00055"></a><a class="code" href="classCBaseRenderer.html#b1">00055</a>       <a class="code" href="classCBaseRenderer.html#b0">CBaseRenderer</a>( <font class="keywordtype">void</font> *packet, <a class="code" href="classCRendererProps.html">CRendererProps</a> caps, <a class="code" href="classCRendererProps.html">CRendererProps</a> reqs,
00056                      <font class="keywordtype">int</font> inQuadsPerVert, <font class="keywordtype">int</font> outQuadsPerVert,
00057                      <font class="keywordtype">int</font> inGeomOffset, <font class="keyword">const</font> <font class="keywordtype">char</font> *name)
00058          : <a class="code" href="classCRenderer.html">CRenderer</a>(caps, reqs),
00059            XferVertices(true), VifDoubleBuffered(true),
00060            WordsPerVertex(0), WordsPerNormal(0), WordsPerTexCoord(0), WordsPerColor(0),
00061            InputQuadsPerVert(inQuadsPerVert), OutputQuadsPerVert(outQuadsPerVert),
00062            InputGeomOffset(inGeomOffset),
00063            MicrocodePacket(packet),
00064            Name(name)
00065       {}
00066 
<a name="l00067"></a><a class="code" href="classCBaseRenderer.html#b2">00067</a>       <font class="keywordtype">void</font> <a class="code" href="classCBaseRenderer.html#b2">SetVifDoubleBuffered</a>( <font class="keywordtype">bool</font> db )<font class="keyword"> </font>{ VifDoubleBuffered = db; }
00068 
00069       <font class="comment">// used by InitXferBlock</font>
00070       <font class="keywordtype">void</font> <a class="code" href="classCBaseRenderer.html#b3">GetUnpackAttribs</a>( <font class="keywordtype">int</font> numWords, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> &amp;mode, Vifs::tMask &amp;mask );
00071 
00072       <font class="comment">// called by DrawArrays</font>
00073       <font class="keywordtype">void</font> <a class="code" href="classCBaseRenderer.html#b4">InitXferBlock</a>( CVifSCDmaPacket &amp;packet,
00074                           <font class="keywordtype">int</font> wordsPerVertex, <font class="keywordtype">int</font> wordsPerNormal,
00075                           <font class="keywordtype">int</font> wordsPerTex, <font class="keywordtype">int</font> wordsPerColor );
00076 
00077       <font class="comment">// used by DrawBlock</font>
00078       <font class="keywordtype">void</font> <a class="code" href="classCBaseRenderer.html#b5">XferBlock</a>( CVifSCDmaPacket &amp;packet,
00079                       <font class="keyword">const</font> <font class="keywordtype">void</font> *vertices, <font class="keyword">const</font> <font class="keywordtype">void</font> *normals,
00080                       <font class="keyword">const</font> <font class="keywordtype">void</font> *texCoords, <font class="keyword">const</font> <font class="keywordtype">void</font> *colors,
00081                       <font class="keywordtype">int</font> vu1Offset, <font class="keywordtype">int</font> firstElement, <font class="keywordtype">int</font> numToAdd );
00082 
00083       <font class="comment">// used by XferBlock</font>
00084       <font class="keywordtype">void</font> <a class="code" href="classCBaseRenderer.html#b6">XferVectors</a>( CVifSCDmaPacket &amp;packet, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> *dataStart,
00085                         <font class="keywordtype">int</font> startOffset, <font class="keywordtype">int</font> numVectors, <font class="keywordtype">int</font> wordsPerVec,
00086                         Vifs::tMask unpackMask, tU32 unpackMode,
00087                         <font class="keywordtype">int</font> vu1MemOffset );
00088 
00089       <font class="comment">// used by InitContext</font>
00090       <font class="keywordtype">void</font> <a class="code" href="classCBaseRenderer.html#b7">AddVu1RendererContext</a>( CVifSCDmaPacket &amp;packet, <a class="code" href="gl_8h.html#a687">GLenum</a> primType, <font class="keywordtype">int</font> vu1Offset );
00091       tGifTag <a class="code" href="classCBaseRenderer.html#b8">BuildGiftag</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> primType );
00092       <font class="keywordtype">void</font> <a class="code" href="classCBaseRenderer.html#b9">CacheRendererState</a>();
00093 
<a name="l00094"></a><a class="code" href="classCBaseRenderer.html#b10">00094</a>       <font class="keywordtype">float</font> <a class="code" href="classCBaseRenderer.html#b10">GetMaxColorValue</a>( <font class="keywordtype">bool</font> texEnabled )<font class="keyword"> </font>{
00095          <font class="comment">// when texturing in modulate mode, 100% of a channel occurs at</font>
00096          <font class="comment">// 0.5 on the gs, so we want a color component value of 1.0 to map to</font>
00097          <font class="comment">// 128, else 255</font>
00098          <font class="keywordflow">return</font> (texEnabled) ? 128.0f : 255.0f;
00099       }
00100    <font class="keyword">public</font>:
00101       <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="classCRenderer.html#a3">Load</a>();
<a name="l00102"></a><a class="code" href="classCBaseRenderer.html#a1">00102</a>       <font class="keyword">virtual</font> <font class="keyword">const</font> <font class="keywordtype">char</font>* <a class="code" href="classCRenderer.html#a9">GetName</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> Name; }
00103 };
00104 
00105 <font class="preprocessor">#endif // ps2gl_base_renderer_h</font>
</pre></div><hr><address><small>ps2gl version cvs</small></address>
