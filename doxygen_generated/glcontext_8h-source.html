<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>glcontext.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>glcontext.h</h1><a href="glcontext_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*        Copyright (C) 2000,2001,2002  Sony Computer Entertainment America</font>
00002           
00003           This file is subject to the terms and conditions of the GNU Lesser
00004           General Public License Version 2.1. See the file "COPYING" in the
00005           main directory of this archive for more details.                             */
00006 
00007 <font class="preprocessor">#ifndef ps2gl_context_h</font>
00008 <font class="preprocessor">#define ps2gl_context_h</font>
00009 
00010 <font class="comment">/********************************************</font>
00011  * includes
00012  */
00013 
00014 <font class="preprocessor">#include "ps2s/packet.h"</font>
00015 <font class="preprocessor">#include "ps2s/gsmem.h"</font>
00016 
00017 <font class="preprocessor">#include "<a class="code" href="gl_8h.html">GL/gl.h</a>"</font>
00018 
00019 <font class="comment">/********************************************</font>
00020  * state change flags
00021  */
00022 
<a name="l00023"></a><a class="code" href="namespaceRendererCtxtFlags.html">00023</a> <font class="keyword">namespace </font>RendererCtxtFlags {
00024    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> NumLights           = 1 &lt;&lt; 0;
00025    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> LightPropChanged    = 1 &lt;&lt; 1;
00026    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> GlobalAmb           = 1 &lt;&lt; 9;
00027    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> CurMaterial         = 1 &lt;&lt; 10;
00028    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> Xform               = 1 &lt;&lt; 11;
00029    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> Prim                = 1 &lt;&lt; 12;
00030    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> Shading             = 1 &lt;&lt; 13;
00031    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> TexEnabled          = 1 &lt;&lt; 14;
00032    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> LightingEnabled     = 1 &lt;&lt; 15;
00033    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> AlphaBlending       = 1 &lt;&lt; 16;
00034    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> CullFaceDir         = 1 &lt;&lt; 17;
00035    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> ClippingEnabled     = 1 &lt;&lt; 18;
00036 }
00037 
<a name="l00038"></a><a class="code" href="namespaceGsCtxtFlags.html">00038</a> <font class="keyword">namespace </font>GsCtxtFlags {
00039    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> Texture             = 1;
00040    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> DrawEnv             = Texture * 2;
00041 }
00042 
<a name="l00048"></a><a class="code" href="namespaceRendererPropFlags.html">00048</a> <font class="keyword">namespace </font>RendererPropFlags {
00049    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> NumLights           = 1;
00050    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> TexEnabled          = NumLights * 2;
00051    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> LightingEnabled     = TexEnabled * 2;
00052    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> SpecularEnabled     = LightingEnabled * 2;
00053    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> PerVtxMaterial      = SpecularEnabled * 2;
00054    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> CullFaceEnabled     = PerVtxMaterial * 2;
00055    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> Prim                = CullFaceEnabled * 2;
00056    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> ArrayAccessType     = Prim * 2;
00057    <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font> ClippingEnabled     = ArrayAccessType * 2;
00058 }
00059 
00060 <font class="comment">/********************************************</font>
00061  * CGLContext
00062  */
00063 
00064 <font class="keyword">class </font><a class="code" href="classCImmMatrixStack.html">CImmMatrixStack</a>;
00065 <font class="keyword">class </font><a class="code" href="classCDListMatrixStack.html">CDListMatrixStack</a>;
00066 <font class="keyword">class </font><a class="code" href="classCMatrixStack.html">CMatrixStack</a>;
00067 
00068 <font class="keyword">class </font><a class="code" href="classCImmLighting.html">CImmLighting</a>;
00069 <font class="keyword">class </font><a class="code" href="classCDListLighting.html">CDListLighting</a>;
00070 <font class="keyword">class </font><a class="code" href="classCLighting.html">CLighting</a>;
00071 
00072 <font class="keyword">class </font><a class="code" href="classCImmGeomManager.html">CImmGeomManager</a>;
00073 <font class="keyword">class </font><a class="code" href="classCDListGeomManager.html">CDListGeomManager</a>;
00074 <font class="keyword">class </font><a class="code" href="classCGeomManager.html">CGeomManager</a>;
00075 
00076 <font class="keyword">class </font><a class="code" href="classCMaterialManager.html">CMaterialManager</a>;
00077 <font class="keyword">class </font><a class="code" href="classCDListManager.html">CDListManager</a>;
00078 <font class="keyword">class </font><a class="code" href="classCTexManager.html">CTexManager</a>;
00079 
00080 <font class="keyword">class </font><a class="code" href="classCImmDrawContext.html">CImmDrawContext</a>;
00081 <font class="keyword">class </font><a class="code" href="classCDListDrawContext.html">CDListDrawContext</a>;
00082 <font class="keyword">class </font><a class="code" href="classCDrawContext.html">CDrawContext</a>;
00083 
00084 <font class="keyword">class </font><a class="code" href="classCDisplayContext.html">CDisplayContext</a>;
00085 
<a name="l00086"></a><a class="code" href="classCGLContext.html">00086</a> <font class="keyword">class </font><a class="code" href="classCGLContext.html">CGLContext</a> {
00087       <a class="code" href="classCImmMatrixStack.html">CImmMatrixStack</a>   *ProjectionMatStack, *ModelViewMatStack;
00088       <a class="code" href="classCDListMatrixStack.html">CDListMatrixStack</a> *DListMatStack;
00089       <a class="code" href="classCMatrixStack.html">CMatrixStack</a>      *CurMatrixStack, *SavedCurMatStack;
00090 
00091       <a class="code" href="classCImmLighting.html">CImmLighting</a>      *ImmLighting;
00092       <a class="code" href="classCDListLighting.html">CDListLighting</a>    *DListLighting;
00093       <a class="code" href="classCLighting.html">CLighting</a>         *CurLighting;
00094 
00095       <a class="code" href="classCImmGeomManager.html">CImmGeomManager</a>   *ImmGManager;
00096       <a class="code" href="classCDListGeomManager.html">CDListGeomManager</a> *DListGManager;
00097       <a class="code" href="classCGeomManager.html">CGeomManager</a>      *CurGManager;
00098 
00099       <a class="code" href="classCMaterialManager.html">CMaterialManager</a>  *MaterialManager;
00100       <a class="code" href="classCDListManager.html">CDListManager</a>     *DListManager;
00101       <a class="code" href="classCTexManager.html">CTexManager</a>       *TexManager;
00102 
00103       <a class="code" href="classCImmDrawContext.html">CImmDrawContext</a>   *ImmDrawContext;
00104       <a class="code" href="classCDListDrawContext.html">CDListDrawContext</a> *DListDrawContext;
00105       <a class="code" href="classCDrawContext.html">CDrawContext</a>      *CurDrawContext;
00106 
00107       <a class="code" href="classCDisplayContext.html">CDisplayContext</a>   *DisplayContext;
00108 
00109       <font class="comment">// state changes</font>
00110 
00111       tU32              RendererContextChanged, SavedRendererContextChanges;
00112       tU32              GsContextChanged, SavedGsContextChanges;
00113       tU32              RendererPropsChanged, SavedRendererPropsChanges;
00114       <font class="keywordtype">bool</font>              StateChangesArePushed;
00115 
00116       <font class="keyword">inline</font> <font class="keywordtype">void</font> PushStateChanges()<font class="keyword"> </font>{
00117          mErrorIf( StateChangesArePushed, <font class="stringliteral">"Trying to push state changes when already pushed."</font> );
00118          SavedRendererContextChanges = RendererContextChanged;
00119          SavedGsContextChanges = GsContextChanged;
00120          SavedRendererPropsChanges = RendererPropsChanged;
00121          StateChangesArePushed = <font class="keyword">true</font>;
00122       }
00123       <font class="keyword">inline</font> <font class="keywordtype">void</font> PopStateChanges()<font class="keyword"> </font>{
00124          mErrorIf( ! StateChangesArePushed,
00125                    <font class="stringliteral">"Trying to pop state changes that haven't been pushed."</font> );
00126          RendererContextChanged = SavedRendererContextChanges;
00127          GsContextChanged = SavedGsContextChanges;
00128          RendererPropsChanged = SavedRendererPropsChanges;
00129          StateChangesArePushed = <font class="keyword">false</font>;
00130       }
00131 
00132       <font class="comment">// rendering loop management</font>
00133 
00134       <font class="keywordtype">bool</font>              IsCurrentFieldEven;
00135       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>      CurrentFrameNumber;
00136 
00137       <font class="comment">// double-buffered dma packets for rendering use</font>
00138       <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font>  kDmaPacketMaxQwordLength = 65000;
00139       <font class="keyword">static</font> CVifSCDmaPacket    *CurPacket, *LastPacket,
00140          *Vif1Packet, *SavedVif1Packet,
00141          *ImmVif1Packet;
00142 
00143       <font class="comment">// double-buffered list of draw environment ptrs so that</font>
00144       <font class="comment">// the dma chains can be reused in different draw buffers,</font>
00145       <font class="comment">// depth buffers, pixel formats, etc.</font>
00146       <font class="comment">// If only they didn't pack so many logically distinct</font>
00147       <font class="comment">// properties into the same registers I wouldn't have to</font>
00148       <font class="comment">// do this!!  Damn!</font>
00149       <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font>  kMaxDrawEnvChanges = 100;
00150       <font class="keywordtype">void</font>              *DrawEnvPtrs0[kMaxDrawEnvChanges];
00151       <font class="keywordtype">void</font>              *DrawEnvPtrs1[kMaxDrawEnvChanges];
00152       <font class="keywordtype">void</font>              **CurDrawEnvPtrs, **LastDrawEnvPtrs;
00153       <font class="keywordtype">int</font>               NumCurDrawEnvPtrs, NumLastDrawEnvPtrs;
00154 
00155       <font class="comment">// list of memory to free after this frame is finished</font>
00156       <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font>  kMaxBuffersToBeFreed = 1024;
00157       <font class="keywordtype">int</font>               CurBuffer;
00158       <font class="keywordtype">void</font>              *BuffersToBeFreed[2][kMaxBuffersToBeFreed];
00159       <font class="keywordtype">int</font>               NumBuffersToBeFreed[2];
00160 
00163 <font class="preprocessor">#ifndef PS2_LINUX</font>
00164       <font class="keyword">static</font> <font class="keyword">const</font> tU64 Ps2glSignalId = 0xffffffff00000000 | (tU32)<font class="charliteral">'G'</font> &lt;&lt; 24 | (tU32)<font class="charliteral">'L'</font> &lt;&lt; 16;
00165 <font class="preprocessor">#else</font>
00166       <font class="keyword">static</font> <font class="keyword">const</font> tU64 Ps2glSignalId = (tU32)<font class="charliteral">'G'</font> &lt;&lt; 24 | (tU32)<font class="charliteral">'L'</font> &lt;&lt; 16;
00167 <font class="preprocessor">#endif</font>
00168 
00170       <font class="keyword">static</font> <font class="keywordtype">int</font>        RenderingFinishedSemaId, ImmediateRenderingFinishedSemaId, VsyncSemaId;
00171 
00172       <font class="keyword">static</font> <font class="keywordtype">int</font> GsIntHandler( <font class="keywordtype">int</font> cause );
00173 
00174       <font class="keywordtype">void</font> FreeWaitingBuffersAndSwap();
00175 
00176       <font class="keywordtype">void</font> EndVif1Packet( <font class="keywordtype">unsigned</font> <font class="keywordtype">short</font> signalNum );
00177 
00178       <font class="keyword">typedef</font> void (* tRenderingFinishedCallback)(<font class="keywordtype">void</font>);
00179       <font class="keyword">static</font> tRenderingFinishedCallback RenderingFinishedCallback;
00180 
00181    <font class="keyword">public</font>:
00182       <a class="code" href="classCGLContext.html#a0">CGLContext</a>( <font class="keywordtype">int</font> immBufferQwordSize, <font class="keywordtype">int</font> immDrawBufferQwordSize );
00183       <a class="code" href="classCGLContext.html#a1">~CGLContext</a>();
00184 
00185       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a2">SetMatrixMode</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> mode );
<a name="l00186"></a><a class="code" href="classCGLContext.html#a3">00186</a>       <font class="keyword">inline</font> <a class="code" href="classCMatrixStack.html">CMatrixStack</a>&amp; <a class="code" href="classCGLContext.html#a3">GetCurMatrixStack</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *CurMatrixStack; }
<a name="l00187"></a><a class="code" href="classCGLContext.html#a4">00187</a>       <font class="keyword">inline</font> <a class="code" href="classCImmMatrixStack.html">CImmMatrixStack</a>&amp; <a class="code" href="classCGLContext.html#a4">GetModelViewStack</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *ModelViewMatStack; }
<a name="l00188"></a><a class="code" href="classCGLContext.html#a5">00188</a>       <font class="keyword">inline</font> <a class="code" href="classCImmMatrixStack.html">CImmMatrixStack</a>&amp; <a class="code" href="classCGLContext.html#a5">GetProjectionStack</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *ProjectionMatStack; }
00189 
<a name="l00190"></a><a class="code" href="classCGLContext.html#a6">00190</a>       <font class="keyword">inline</font> <a class="code" href="classCLighting.html">CLighting</a>&amp; <a class="code" href="classCGLContext.html#a6">GetLighting</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *CurLighting; }
<a name="l00191"></a><a class="code" href="classCGLContext.html#a7">00191</a>       <font class="keyword">inline</font> <a class="code" href="classCImmLighting.html">CImmLighting</a>&amp; <a class="code" href="classCGLContext.html#a7">GetImmLighting</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *ImmLighting; }
<a name="l00192"></a><a class="code" href="classCGLContext.html#a8">00192</a>       <font class="keyword">inline</font> <a class="code" href="classCDListLighting.html">CDListLighting</a>&amp; <a class="code" href="classCGLContext.html#a8">GetDListLighting</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *DListLighting; }
00193 
<a name="l00194"></a><a class="code" href="classCGLContext.html#a9">00194</a>       <font class="keyword">inline</font> <a class="code" href="classCGeomManager.html">CGeomManager</a>&amp; <a class="code" href="classCGLContext.html#a9">GetGeomManager</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *CurGManager; }
<a name="l00195"></a><a class="code" href="classCGLContext.html#a10">00195</a>       <font class="keyword">inline</font> <a class="code" href="classCImmGeomManager.html">CImmGeomManager</a>&amp; <a class="code" href="classCGLContext.html#a10">GetImmGeomManager</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *ImmGManager; }
<a name="l00196"></a><a class="code" href="classCGLContext.html#a11">00196</a>       <font class="keyword">inline</font> <a class="code" href="classCDListGeomManager.html">CDListGeomManager</a>&amp; <a class="code" href="classCGLContext.html#a11">GetDListGeomManager</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *DListGManager; }
00197 
<a name="l00198"></a><a class="code" href="classCGLContext.html#a12">00198</a>       <font class="keyword">inline</font> <a class="code" href="classCMaterialManager.html">CMaterialManager</a>&amp; <a class="code" href="classCGLContext.html#a12">GetMaterialManager</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *MaterialManager; }
00199 
<a name="l00200"></a><a class="code" href="classCGLContext.html#a13">00200</a>       <font class="keyword">inline</font> <a class="code" href="classCDListManager.html">CDListManager</a>&amp; <a class="code" href="classCGLContext.html#a13">GetDListManager</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *DListManager; }
00201 
<a name="l00202"></a><a class="code" href="classCGLContext.html#a14">00202</a>       <font class="keyword">inline</font> <a class="code" href="classCTexManager.html">CTexManager</a>&amp; <a class="code" href="classCGLContext.html#a14">GetTexManager</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *TexManager; }
00203 
<a name="l00204"></a><a class="code" href="classCGLContext.html#a15">00204</a>       <font class="keyword">inline</font> <a class="code" href="classCDrawContext.html">CDrawContext</a>&amp; <a class="code" href="classCGLContext.html#a15">GetDrawContext</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *CurDrawContext; }
<a name="l00205"></a><a class="code" href="classCGLContext.html#a16">00205</a>       <font class="keyword">inline</font> <a class="code" href="classCImmDrawContext.html">CImmDrawContext</a>&amp; <a class="code" href="classCGLContext.html#a16">GetImmDrawContext</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *ImmDrawContext; }
<a name="l00206"></a><a class="code" href="classCGLContext.html#a17">00206</a>       <font class="keyword">inline</font> <a class="code" href="classCDListDrawContext.html">CDListDrawContext</a>&amp; <a class="code" href="classCGLContext.html#a17">GetDListDrawContext</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *DListDrawContext; }
00207 
<a name="l00208"></a><a class="code" href="classCGLContext.html#a18">00208</a>       <font class="keyword">inline</font> <a class="code" href="classCDisplayContext.html">CDisplayContext</a>&amp; <a class="code" href="classCGLContext.html#a18">GetDisplayContext</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *DisplayContext; }
00209 
<a name="l00210"></a><a class="code" href="classCGLContext.html#a19">00210</a>       <font class="keyword">inline</font> <font class="keywordtype">bool</font> <a class="code" href="classCGLContext.html#a19">InDListDef</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> CurGManager != (<a class="code" href="classCGeomManager.html">CGeomManager</a>*)ImmGManager; }
00211       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a20">BeginDListDef</a>( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> listID, <a class="code" href="gl_8h.html#a687">GLenum</a> mode );
00212       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a21">EndDListDef</a>();
00213 
00214       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a22">BeginImmediateGeometry</a>();
00215       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a23">EndImmediateGeometry</a>();
00216       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a24">RenderImmediateGeometry</a>();
00217       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a25">FinishRenderingImmediateGeometry</a>( <font class="keywordtype">bool</font> forceImmediateStop );
00218 
00219       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a26">BeginGeometry</a>();
00220       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a27">EndGeometry</a>();
00221       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a28">RenderGeometry</a>();
00222       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a29">FinishRenderingGeometry</a>( <font class="keywordtype">bool</font> forceImmediateStop );
00223 
<a name="l00224"></a><a class="code" href="classCGLContext.html#a30">00224</a>       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a30">AddingDrawEnvToPacket</a>( <font class="keywordtype">void</font> *de )<font class="keyword"> </font>{
00225          mErrorIf( NumCurDrawEnvPtrs == kMaxDrawEnvChanges,
00226                    <font class="stringliteral">"Too many draw environment changes.  Need to increase kMaxDrawEnvChanges"</font> );
00227          CurDrawEnvPtrs[NumCurDrawEnvPtrs++] = de;
00228       }
<a name="l00229"></a><a class="code" href="classCGLContext.html#a31">00229</a>       <font class="keywordtype">void</font>** <a class="code" href="classCGLContext.html#a31">GetDrawEnvPtrs</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> LastDrawEnvPtrs; }
<a name="l00230"></a><a class="code" href="classCGLContext.html#a32">00230</a>       <font class="keywordtype">int</font> <a class="code" href="classCGLContext.html#a32">GetNumDrawEnvPtrs</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> NumLastDrawEnvPtrs; }
00231 
<a name="l00232"></a><a class="code" href="classCGLContext.html#a33">00232</a>       <font class="keywordtype">bool</font> <a class="code" href="classCGLContext.html#a33">GetCurrentFieldIsEven</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> IsCurrentFieldEven; }
00233 
<a name="l00238"></a><a class="code" href="classCGLContext.html#d0">00238</a>       <font class="keyword">static</font> tU16 <a class="code" href="classCGLContext.html#d0">GetPs2glSignalId</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> (tU16)(Ps2glSignalId &gt;&gt; 16); }
00239 
<a name="l00244"></a><a class="code" href="classCGLContext.html#a34">00244</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a34">AddBufferToBeFreed</a>( <font class="keywordtype">void</font> *buf )<font class="keyword"> </font>{
00245          mAssert( NumBuffersToBeFreed[CurBuffer] &lt; kMaxBuffersToBeFreed );
00246          BuffersToBeFreed[CurBuffer][NumBuffersToBeFreed[CurBuffer]++] = buf;
00247       }
00248 
<a name="l00249"></a><a class="code" href="classCGLContext.html#d1">00249</a>       <font class="keyword">inline</font> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#d1">SetRenderingFinishedCallback</a>( tRenderingFinishedCallback cb )<font class="keyword"> </font>{
00250          RenderingFinishedCallback = cb;
00251       }
00252 
00253       <font class="comment">// state updates</font>
00254 
<a name="l00255"></a><a class="code" href="classCGLContext.html#a35">00255</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a35">NumLightsChanged</a>()<font class="keyword"> </font>{
00256          RendererContextChanged |= RendererCtxtFlags::NumLights;
00257          RendererPropsChanged |= RendererPropFlags::NumLights;
00258       }
<a name="l00259"></a><a class="code" href="classCGLContext.html#a36">00259</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a36">LightPropChanged</a>()<font class="keyword"> </font>{
00260          RendererContextChanged |= RendererCtxtFlags::LightPropChanged;
00261       }
<a name="l00262"></a><a class="code" href="classCGLContext.html#a37">00262</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a37">GlobalAmbChanged</a>()<font class="keyword"> </font>{
00263          RendererContextChanged |= RendererCtxtFlags::GlobalAmb;
00264       }
<a name="l00265"></a><a class="code" href="classCGLContext.html#a38">00265</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a38">CurMaterialChanged</a>()<font class="keyword"> </font>{
00266          RendererContextChanged |= RendererCtxtFlags::CurMaterial;
00267       }
<a name="l00268"></a><a class="code" href="classCGLContext.html#a39">00268</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a39">XformChanged</a>()<font class="keyword"> </font>{
00269          RendererContextChanged |= RendererCtxtFlags::Xform;
00270       }
<a name="l00271"></a><a class="code" href="classCGLContext.html#a40">00271</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a40">PrimChanged</a>()<font class="keyword"> </font>{
00272          RendererContextChanged |= RendererCtxtFlags::Prim;
00273          RendererPropsChanged |= RendererPropFlags::Prim;
00274       }
<a name="l00275"></a><a class="code" href="classCGLContext.html#a41">00275</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a41">ShadingChanged</a>()<font class="keyword"> </font>{
00276          RendererContextChanged |= RendererCtxtFlags::Shading;
00277       }
<a name="l00278"></a><a class="code" href="classCGLContext.html#a42">00278</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a42">TexEnabledChanged</a>()<font class="keyword"> </font>{
00279          RendererContextChanged |= RendererCtxtFlags::TexEnabled;
00280          RendererPropsChanged |= RendererPropFlags::TexEnabled;
00281          GsContextChanged |= GsCtxtFlags::Texture;
00282       }
<a name="l00283"></a><a class="code" href="classCGLContext.html#a43">00283</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a43">LightingEnabledChanged</a>()<font class="keyword"> </font>{
00284          RendererContextChanged |= RendererCtxtFlags::LightingEnabled;
00285          RendererPropsChanged |= RendererPropFlags::LightingEnabled;
00286       }
<a name="l00287"></a><a class="code" href="classCGLContext.html#a44">00287</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a44">BlendEnabledChanged</a>()<font class="keyword"> </font>{
00288          RendererContextChanged |= RendererCtxtFlags::AlphaBlending;
00289       }
<a name="l00290"></a><a class="code" href="classCGLContext.html#a45">00290</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a45">DrawEnvChanged</a>()<font class="keyword"> </font>{
00291          GsContextChanged |= GsCtxtFlags::DrawEnv;
00292       }
<a name="l00293"></a><a class="code" href="classCGLContext.html#a46">00293</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a46">AlphaTestEnabledChanged</a>()<font class="keyword"> </font>{
00294          GsContextChanged |= GsCtxtFlags::DrawEnv;
00295       }
<a name="l00296"></a><a class="code" href="classCGLContext.html#a47">00296</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a47">DrawInterlacedChanged</a>()<font class="keyword"> </font>{
00297          GsContextChanged |= GsCtxtFlags::DrawEnv;
00298       }
<a name="l00299"></a><a class="code" href="classCGLContext.html#a48">00299</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a48">AlphaTestFuncChanged</a>()<font class="keyword"> </font>{
00300          GsContextChanged |= GsCtxtFlags::DrawEnv;
00301       }
<a name="l00302"></a><a class="code" href="classCGLContext.html#a49">00302</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a49">DepthWriteEnabledChanged</a>()<font class="keyword"> </font>{
00303          GsContextChanged |= GsCtxtFlags::DrawEnv;
00304       }
<a name="l00305"></a><a class="code" href="classCGLContext.html#a50">00305</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a50">FrameBufferDrawMaskChanged</a>()<font class="keyword"> </font>{
00306          GsContextChanged |= GsCtxtFlags::DrawEnv;
00307       }
<a name="l00308"></a><a class="code" href="classCGLContext.html#a51">00308</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a51">SpecularEnabledChanged</a>()<font class="keyword"> </font>{
00309          RendererPropsChanged |= RendererPropFlags::SpecularEnabled;
00310       }
<a name="l00311"></a><a class="code" href="classCGLContext.html#a52">00311</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a52">TextureChanged</a>()<font class="keyword"> </font>{
00312          GsContextChanged |= GsCtxtFlags::Texture;
00313       }
<a name="l00314"></a><a class="code" href="classCGLContext.html#a53">00314</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a53">BlendModeChanged</a>()<font class="keyword"> </font>{
00315          GsContextChanged |= GsCtxtFlags::DrawEnv;
00316       }
<a name="l00317"></a><a class="code" href="classCGLContext.html#a54">00317</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a54">DrawBufferChanged</a>()<font class="keyword"> </font>{
00318          GsContextChanged |= GsCtxtFlags::DrawEnv;
00319       }
<a name="l00320"></a><a class="code" href="classCGLContext.html#a55">00320</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a55">PerVtxMaterialChanged</a>()<font class="keyword"> </font>{
00321          RendererPropsChanged |= RendererPropFlags::PerVtxMaterial;
00322       }
<a name="l00323"></a><a class="code" href="classCGLContext.html#a56">00323</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a56">ClippingEnabledChanged</a>()<font class="keyword"> </font>{
00324          RendererPropsChanged |= RendererPropFlags::ClippingEnabled;
00325          RendererContextChanged |= RendererCtxtFlags::ClippingEnabled;
00326       }
<a name="l00327"></a><a class="code" href="classCGLContext.html#a57">00327</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a57">CullFaceEnabledChanged</a>()<font class="keyword"> </font>{
00328          RendererPropsChanged |= RendererPropFlags::CullFaceEnabled;
00329       }
<a name="l00330"></a><a class="code" href="classCGLContext.html#a58">00330</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a58">CullFaceDirChanged</a>()<font class="keyword"> </font>{
00331          RendererContextChanged |= RendererCtxtFlags::CullFaceDir;
00332       }
<a name="l00333"></a><a class="code" href="classCGLContext.html#a59">00333</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a59">ArrayAccessChanged</a>()<font class="keyword"> </font>{
00334          RendererPropsChanged |= RendererPropFlags::ArrayAccessType;
00335       }
<a name="l00336"></a><a class="code" href="classCGLContext.html#a60">00336</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a60">PolyModeChanged</a>()<font class="keyword"> </font>{
00337          RendererContextChanged |= RendererCtxtFlags::Prim;
00338       }
00339 
00340       <font class="comment">// ps2 rendering</font>
00341 
<a name="l00342"></a><a class="code" href="classCGLContext.html#a61">00342</a>       <font class="keyword">inline</font> tU32 <a class="code" href="classCGLContext.html#a61">GetRendererContextChanged</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> RendererContextChanged; }
<a name="l00343"></a><a class="code" href="classCGLContext.html#a62">00343</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a62">SetRendererContextChanged</a>( <font class="keywordtype">bool</font> changed )<font class="keyword"> </font>{
00344          RendererContextChanged = (changed) ? 0xff : 0;
00345       }
00346 
<a name="l00347"></a><a class="code" href="classCGLContext.html#a63">00347</a>       <font class="keyword">inline</font> tU32 <a class="code" href="classCGLContext.html#a63">GetGsContextChanged</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> GsContextChanged; }
<a name="l00348"></a><a class="code" href="classCGLContext.html#a64">00348</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a64">SetGsContextChanged</a>( <font class="keywordtype">bool</font> changed )<font class="keyword"> </font>{
00349          GsContextChanged = (changed) ? 0xff : 0;
00350       }
00351 
<a name="l00352"></a><a class="code" href="classCGLContext.html#a65">00352</a>       <font class="keyword">inline</font> tU32 <a class="code" href="classCGLContext.html#a65">GetRendererPropsChanged</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> RendererPropsChanged; }
<a name="l00353"></a><a class="code" href="classCGLContext.html#a66">00353</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a66">SetRendererPropsChanged</a>( <font class="keywordtype">bool</font> changed )<font class="keyword"> </font>{
00354          RendererPropsChanged = (changed) ? 0xff : 0;
00355       }
00356 
<a name="l00357"></a><a class="code" href="classCGLContext.html#a67">00357</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a67">PushVif1Packet</a>()<font class="keyword"> </font>{
00358          mAssert(SavedVif1Packet == NULL);
00359          SavedVif1Packet = Vif1Packet;
00360       }
<a name="l00361"></a><a class="code" href="classCGLContext.html#a68">00361</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a68">PopVif1Packet</a>()<font class="keyword"> </font>{
00362          mAssert(SavedVif1Packet != NULL);
00363          Vif1Packet = SavedVif1Packet;
00364          SavedVif1Packet = NULL;
00365       }
<a name="l00366"></a><a class="code" href="classCGLContext.html#a69">00366</a>       <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a69">SetVif1Packet</a>( CVifSCDmaPacket &amp;packet )<font class="keyword"> </font>{ Vif1Packet = &amp;packet; }
<a name="l00367"></a><a class="code" href="classCGLContext.html#a70">00367</a>       <font class="keyword">inline</font> CVifSCDmaPacket&amp; <a class="code" href="classCGLContext.html#a70">GetVif1Packet</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> *Vif1Packet; }
00368 
00369       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a71">WaitForVSync</a>();
00370       <font class="keywordtype">void</font> <a class="code" href="classCGLContext.html#a72">SwapBuffers</a>();
00371 };
00372 
00373 <font class="comment">// global pointer to the GLContext</font>
<a name="l00374"></a><a class="code" href="glcontext_8h.html#a0">00374</a> <font class="keyword">extern</font> <a class="code" href="classCGLContext.html">CGLContext</a> *pGLContext;
00375 
00376 <font class="preprocessor">#endif // ps2gl_context_h</font>
</pre></div><hr><address><small>ps2gl version cvs</small></address>
