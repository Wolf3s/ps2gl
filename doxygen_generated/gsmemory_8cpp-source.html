<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>gsmemory.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>gsmemory.cpp</h1><a href="gsmemory_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*        Copyright (C) 2000,2001,2002  Sony Computer Entertainment America</font>
00002           
00003           This file is subject to the terms and conditions of the GNU Lesser
00004           General Public License Version 2.1. See the file "COPYING" in the
00005           main directory of this archive for more details.                             */
00006 
00007 <font class="preprocessor">#include "<a class="code" href="ps2gl_8h.html">GL/ps2gl.h</a>"</font>
00008 
00009 <font class="preprocessor">#include "ps2s/gsmem.h"</font>
00010 
00016 <font class="keyword">static</font> <font class="keywordtype">bool</font> GsMemInitted = <font class="keyword">false</font>;
00017 
00023 <font class="comment">// gs mem</font>
00024 
00040 <font class="keywordtype">void</font>
<a name="l00041"></a><a class="code" href="group__gs__mem.html#a19">00041</a> <a class="code" href="group__gs__mem.html#a0">pglPrintGsMemAllocation</a>()<font class="keyword"></font>
00042 {
00043    GS::CMemManager &amp;mm = GS::CMemArea::GetMemManager();
00044    mm.PrintAllocation();
00045 }
00046 
00051 <font class="keywordtype">int</font>
<a name="l00052"></a><a class="code" href="group__gs__mem.html#a20">00052</a> <a class="code" href="group__gs__mem.html#a1">pglHasGsMemBeenInitted</a>()<font class="keyword"></font>
00053 {
00054    <font class="keywordflow">return</font> GsMemInitted;
00055 }
00056 
00057 <font class="comment">// slots</font>
00058 
00120 <a class="code" href="ps2gl_8h.html#a11">pgl_slot_handle_t</a>
<a name="l00121"></a><a class="code" href="group__gs__mem__slots.html#a21">00121</a> <a class="code" href="group__gs__mem__slots.html#a21">pglAddGsMemSlot</a>( <font class="keywordtype">int</font> startingPage, <font class="keywordtype">int</font> pageLength, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> pixelMode )<font class="keyword"></font>
00122 {
00123    GS::CMemManager &amp;mm = GS::CMemArea::GetMemManager();
00124    GS::CMemSlot *newSlot = mm.AddSlot( startingPage, pageLength, (GS::tPSM)pixelMode );
00125 
00126    GsMemInitted = <font class="keyword">true</font>;
00127 
00128    <font class="keywordflow">return</font> reinterpret_cast&lt;pgl_slot_handle_t&gt;( newSlot );
00129 }
00130 
00135 <font class="keywordtype">void</font>
<a name="l00136"></a><a class="code" href="group__gs__mem__slots.html#a22">00136</a> <a class="code" href="group__gs__mem__slots.html#a22">pglLockGsMemSlot</a>( <a class="code" href="ps2gl_8h.html#a11">pgl_slot_handle_t</a> slot_handle )<font class="keyword"></font>
00137 {
00138    GS::CMemSlot *slot = reinterpret_cast&lt;GS::CMemSlot*&gt;(slot_handle);
00139    slot-&gt;Lock();
00140 }
00141 
00146 <font class="keywordtype">void</font>
<a name="l00147"></a><a class="code" href="group__gs__mem__slots.html#a23">00147</a> <a class="code" href="group__gs__mem__slots.html#a23">pglUnlockGsMemSlot</a>( <a class="code" href="ps2gl_8h.html#a11">pgl_slot_handle_t</a> slot_handle )<font class="keyword"></font>
00148 {
00149    GS::CMemSlot *slot = reinterpret_cast&lt;GS::CMemSlot*&gt;(slot_handle);
00150    slot-&gt;Unlock();
00151 }
00152 
00156 <font class="keywordtype">void</font>
<a name="l00157"></a><a class="code" href="group__gs__mem__slots.html#a24">00157</a> <a class="code" href="group__gs__mem__slots.html#a3">pglRemoveAllGsMemSlots</a>()<font class="keyword"></font>
00158 {
00159    GS::CMemManager &amp;mm = GS::CMemArea::GetMemManager();
00160    mm.RemoveAllSlots();
00161 }
00162  <font class="comment">// gs_mem_slots</font>
00164 
00165 <font class="comment">// mem area operations</font>
00166 
00190 <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a>
<a name="l00191"></a><a class="code" href="group__gs__mem__areas.html#a25">00191</a> <a class="code" href="group__gs__mem__areas.html#a25">pglCreateGsMemArea</a>( <font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> pix_format )<font class="keyword"></font>
00192 {
00193    GS::CMemArea *newArea = <font class="keyword">new</font> GS::CMemArea( width, height, (GS::tPSM)pix_format );
00194    <font class="keywordflow">return</font> reinterpret_cast&lt;pgl_area_handle_t&gt;(newArea);
00195 }
00196 
00200 <font class="keywordtype">void</font>
<a name="l00201"></a><a class="code" href="group__gs__mem__areas.html#a26">00201</a> <a class="code" href="group__gs__mem__areas.html#a26">pglDestroyGsMemArea</a>( <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> mem_area )<font class="keyword"></font>
00202 {
00203    GS::CMemArea *area = reinterpret_cast&lt;GS::CMemArea*&gt;(mem_area);
00204    <font class="keyword">delete</font> area;
00205 }
00206 
00217 <font class="keywordtype">void</font>
<a name="l00218"></a><a class="code" href="group__gs__mem__areas.html#a27">00218</a> <a class="code" href="group__gs__mem__areas.html#a27">pglAllocGsMemArea</a>( <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> mem_area )<font class="keyword"></font>
00219 {
00220    GS::CMemArea *area = reinterpret_cast&lt;GS::CMemArea*&gt;(mem_area);
00221    area-&gt;Alloc();
00222 }
00223 
00228 <font class="keywordtype">void</font>
<a name="l00229"></a><a class="code" href="group__gs__mem__areas.html#a28">00229</a> <a class="code" href="group__gs__mem__areas.html#a28">pglFreeGsMemArea</a>( <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> mem_area )<font class="keyword"></font>
00230 {
00231    GS::CMemArea *area = reinterpret_cast&lt;GS::CMemArea*&gt;(mem_area);
00232    area-&gt;Free();
00233 }
00234 
00240 <font class="keywordtype">void</font>
<a name="l00241"></a><a class="code" href="group__gs__mem__areas.html#a29">00241</a> <a class="code" href="group__gs__mem__areas.html#a29">pglSetGsMemAreaWordAddr</a>( <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> mem_area, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> addr )<font class="keyword"></font>
00242 {
00243    GS::CMemArea *area = reinterpret_cast&lt;GS::CMemArea*&gt;(mem_area);
00244    area-&gt;SetWordAddr(addr);
00245 }
00246 
00251 <font class="keywordtype">void</font>
<a name="l00252"></a><a class="code" href="group__gs__mem__areas.html#a30">00252</a> <a class="code" href="group__gs__mem__areas.html#a30">pglBindGsMemAreaToSlot</a>( <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> mem_area, <a class="code" href="ps2gl_8h.html#a11">pgl_slot_handle_t</a> mem_slot )<font class="keyword"></font>
00253 {
00254    GS::CMemArea *area = reinterpret_cast&lt;GS::CMemArea*&gt;(mem_area);
00255    GS::CMemSlot *slot = reinterpret_cast&lt;GS::CMemSlot*&gt;(mem_slot);
00256    slot-&gt;Bind( *area, 0 ); <font class="comment">// FIXME: current frame number</font>
00257 }
00258 
00262 <font class="keywordtype">void</font>
<a name="l00263"></a><a class="code" href="group__gs__mem__areas.html#a31">00263</a> <a class="code" href="group__gs__mem__areas.html#a31">pglUnbindGsMemArea</a>( <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> mem_area )<font class="keyword"></font>
00264 {
00265    GS::CMemArea *area = reinterpret_cast&lt;GS::CMemArea*&gt;(mem_area);
00266    area-&gt;Unbind();
00267 }
00268 
00273 <font class="keywordtype">void</font>
<a name="l00274"></a><a class="code" href="group__gs__mem__areas.html#a32">00274</a> <a class="code" href="group__gs__mem__areas.html#a32">pglLockGsMemArea</a>( <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> mem_area )<font class="keyword"></font>
00275 {
00276    GS::CMemArea *area = reinterpret_cast&lt;GS::CMemArea*&gt;(mem_area);
00277    area-&gt;Lock();
00278 }
00282 <font class="keywordtype">void</font>
<a name="l00283"></a><a class="code" href="group__gs__mem__areas.html#a33">00283</a> <a class="code" href="group__gs__mem__areas.html#a33">pglUnlockGsMemArea</a>( <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> mem_area )<font class="keyword"></font>
00284 {
00285    GS::CMemArea *area = reinterpret_cast&lt;GS::CMemArea*&gt;(mem_area);
00286    area-&gt;Unlock();
00287 }
00291 <font class="keywordtype">int</font>
<a name="l00292"></a><a class="code" href="group__gs__mem__areas.html#a34">00292</a> <a class="code" href="group__gs__mem__areas.html#a34">pglGsMemAreaIsAllocated</a>( <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> mem_area )<font class="keyword"></font>
00293 {
00294    GS::CMemArea *area = reinterpret_cast&lt;GS::CMemArea*&gt;(mem_area);
00295    <font class="keywordflow">return</font> (int)area-&gt;IsAllocated();
00296 }
00300 <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>
<a name="l00301"></a><a class="code" href="group__gs__mem__areas.html#a35">00301</a> <a class="code" href="group__gs__mem__areas.html#a35">pglGetGsMemAreaWordAddr</a>( <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> mem_area )<font class="keyword"></font>
00302 {
00303    GS::CMemArea *area = reinterpret_cast&lt;GS::CMemArea*&gt;(mem_area);
00304    <font class="keywordflow">return</font> area-&gt;GetWordAddr();
00305 }
00306  <font class="comment">// gs_mem_areas</font>
00308  <font class="comment">// gs_mem</font>
00310  <font class="comment">// pgl_api</font>
</pre></div><hr><address><small>ps2gl version cvs</small></address>
