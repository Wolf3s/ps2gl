<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>matrix.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>matrix.h</h1><a href="matrix_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*        Copyright (C) 2000,2001,2002  Sony Computer Entertainment America</font>
00002           
00003           This file is subject to the terms and conditions of the GNU Lesser
00004           General Public License Version 2.1. See the file "COPYING" in the
00005           main directory of this archive for more details.                             */
00006 
00007 <font class="preprocessor">#ifndef ps2gl_matrix_h</font>
00008 <font class="preprocessor">#define ps2gl_matrix_h</font>
00009 
00010 <font class="preprocessor">#include "<a class="code" href="debug_8h.html">ps2gl/debug.h</a>"</font>
00011 <font class="preprocessor">#include "ps2s/cpu_matrix.h"</font>
00012 
00013 <font class="preprocessor">#include "<a class="code" href="glcontext_8h.html">ps2gl/glcontext.h</a>"</font>
00014 <font class="preprocessor">#include "<a class="code" href="drawcontext_8h.html">ps2gl/drawcontext.h</a>"</font>
00015 
00016 <font class="comment">/********************************************</font>
00017  * CMatrixStack
00018  */
00019 
00020 <font class="keyword">class </font><a class="code" href="classCGLContext.html">CGLContext</a>;
00021 
<a name="l00022"></a><a class="code" href="classCMatrixStack.html">00022</a> <font class="keyword">class </font><a class="code" href="classCMatrixStack.html">CMatrixStack</a> {
00023    <font class="keyword">protected</font>:
<a name="l00024"></a><a class="code" href="classCMatrixStack.html#n0">00024</a>       <a class="code" href="classCGLContext.html">CGLContext</a>        &amp;GLContext;
<a name="l00025"></a><a class="code" href="classCMatrixStack.html#q0">00025</a>       <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">int</font>  MaxStackDepth = 16;
<a name="l00026"></a><a class="code" href="classCMatrixStack.html#n1">00026</a>       cpu_mat_44                Matrices[MaxStackDepth], InverseMatrices[MaxStackDepth];
<a name="l00027"></a><a class="code" href="classCMatrixStack.html#n3">00027</a>       <font class="keywordtype">int</font>               CurStackDepth;
00028 
00029    <font class="keyword">public</font>:
<a name="l00030"></a><a class="code" href="classCMatrixStack.html#a0">00030</a>       <a class="code" href="classCMatrixStack.html#a0">CMatrixStack</a>( <a class="code" href="classCGLContext.html">CGLContext</a> &amp;context )
00031          : GLContext(context), CurStackDepth(0)
00032       {
00033          Matrices[0].set_identity();
00034          InverseMatrices[0].set_identity();
00035       }
00036 
00037       <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a1">Pop</a>() = 0;
00038       <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a2">Push</a>() = 0;
00039       <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a3">Concat</a>( <font class="keyword">const</font> cpu_mat_44&amp; xform, <font class="keyword">const</font> cpu_mat_44&amp; inverse ) = 0;
00040       <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a4">SetTop</a>( <font class="keyword">const</font> cpu_mat_44 &amp;newMat, <font class="keyword">const</font> cpu_mat_44 &amp;newInv ) = 0;
00041 };
00042 
00043 <font class="comment">/********************************************</font>
00044  * CImmMatrixStack
00045  */
00046 
<a name="l00047"></a><a class="code" href="classCImmMatrixStack.html">00047</a> <font class="keyword">class</font> <a class="code" href="classCImmMatrixStack.html">CImmMatrixStack</a> : <font class="keyword">public</font> <a class="code" href="classCMatrixStack.html">CMatrixStack</a> {
00048    <font class="keyword">public</font>:
<a name="l00049"></a><a class="code" href="classCImmMatrixStack.html#a0">00049</a>       CImmMatrixStack( <a class="code" href="classCGLContext.html">CGLContext</a> &amp;context ) : <a class="code" href="classCMatrixStack.html">CMatrixStack</a>(context) {}
00050 
<a name="l00051"></a><a class="code" href="classCImmMatrixStack.html#a1">00051</a>       <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a1">Pop</a>()<font class="keyword"> </font>{
00052          mErrorIf( CurStackDepth == 0, <font class="stringliteral">"No matrices to pop!"</font> );
00053          --CurStackDepth;
00054          GLContext.<a class="code" href="classCGLContext.html#a16">GetImmDrawContext</a>().<a class="code" href="classCImmDrawContext.html#a6">SetVertexXformValid</a>(<font class="keyword">false</font>);
00055       }
00056 
<a name="l00057"></a><a class="code" href="classCImmMatrixStack.html#a2">00057</a>       <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a2">Push</a>()<font class="keyword"> </font>{
00058          mErrorIf( CurStackDepth == MaxStackDepth - 1,
00059                    <font class="stringliteral">"No room on stack!"</font> );
00060          Matrices[CurStackDepth + 1] = Matrices[CurStackDepth];
00061          InverseMatrices[CurStackDepth + 1] = InverseMatrices[CurStackDepth];
00062          ++CurStackDepth;
00063       }
00064 
<a name="l00065"></a><a class="code" href="classCImmMatrixStack.html#a3">00065</a>       <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a3">Concat</a>( <font class="keyword">const</font> cpu_mat_44&amp; xform, <font class="keyword">const</font> cpu_mat_44&amp; inverse )<font class="keyword"> </font>{
00066          cpu_mat_44 &amp;curMat = Matrices[CurStackDepth];
00067          cpu_mat_44 &amp;curInv = InverseMatrices[CurStackDepth];
00068          curMat = curMat * xform;
00069          curInv = inverse * curInv;
00070          GLContext.<a class="code" href="classCGLContext.html#a16">GetImmDrawContext</a>().<a class="code" href="classCImmDrawContext.html#a6">SetVertexXformValid</a>(<font class="keyword">false</font>);
00071       }
00072 
<a name="l00073"></a><a class="code" href="classCImmMatrixStack.html#a4">00073</a>       <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a4">SetTop</a>( <font class="keyword">const</font> cpu_mat_44 &amp;newMat, <font class="keyword">const</font> cpu_mat_44 &amp;newInv )<font class="keyword"> </font>{
00074          Matrices[CurStackDepth] = newMat;
00075          InverseMatrices[CurStackDepth] = newInv;
00076          GLContext.<a class="code" href="classCGLContext.html#a16">GetImmDrawContext</a>().<a class="code" href="classCImmDrawContext.html#a6">SetVertexXformValid</a>(<font class="keyword">false</font>);
00077       }
00078 
<a name="l00079"></a><a class="code" href="classCImmMatrixStack.html#a5">00079</a>       <font class="keyword">const</font> cpu_mat_44 &amp; GetTop()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> Matrices[CurStackDepth]; }
<a name="l00080"></a><a class="code" href="classCImmMatrixStack.html#a6">00080</a>       <font class="keyword">const</font> cpu_mat_44 &amp; GetInvTop()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> InverseMatrices[CurStackDepth]; }
00081 };
00082 
00083 <font class="comment">/********************************************</font>
00084  * CDListMatrixStack
00085  */
00086 
<a name="l00087"></a><a class="code" href="classCDListMatrixStack.html">00087</a> <font class="keyword">class </font><a class="code" href="classCDListMatrixStack.html">CDListMatrixStack</a> : <font class="keyword">public</font> <a class="code" href="classCMatrixStack.html">CMatrixStack</a> {
00088    <font class="keyword">public</font>:
<a name="l00089"></a><a class="code" href="classCDListMatrixStack.html#a0">00089</a>       <a class="code" href="classCDListMatrixStack.html#a0">CDListMatrixStack</a>( <a class="code" href="classCGLContext.html">CGLContext</a> &amp;context ) : <a class="code" href="classCMatrixStack.html">CMatrixStack</a>(context) {}
00090 
00091       <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a1">Pop</a>();
00092       <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a2">Push</a>();
00093       <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a3">Concat</a>( <font class="keyword">const</font> cpu_mat_44&amp; xform, <font class="keyword">const</font> cpu_mat_44&amp; inverse );
00094       <font class="keywordtype">void</font> <a class="code" href="classCMatrixStack.html#a4">SetTop</a>( <font class="keyword">const</font> cpu_mat_44 &amp;newMat, <font class="keyword">const</font> cpu_mat_44 &amp;newInv );
00095 };
00096 
00097 <font class="preprocessor">#endif // ps2gl_matrix_h</font>
</pre></div><hr><address><small>ps2gl version cvs</small></address>
