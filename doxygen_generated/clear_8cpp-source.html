<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>clear.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>clear.cpp</h1><a href="clear_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*        Copyright (C) 2000,2001,2002  Sony Computer Entertainment America</font>
00002           
00003           This file is subject to the terms and conditions of the GNU Lesser
00004           General Public License Version 2.1. See the file "COPYING" in the
00005           main directory of this archive for more details.                             */
00006 
00007 <font class="preprocessor">#include "ps2s/math.h"</font>
00008 <font class="preprocessor">#include "ps2s/packet.h"</font>
00009 
00010 <font class="preprocessor">#include "<a class="code" href="clear_8h.html">ps2gl/clear.h</a>"</font>
00011 <font class="preprocessor">#include "<a class="code" href="glcontext_8h.html">ps2gl/glcontext.h</a>"</font>
00012 <font class="preprocessor">#include "<a class="code" href="immgmanager_8h.html">ps2gl/immgmanager.h</a>"</font>
00013 <font class="preprocessor">#include "<a class="code" href="drawcontext_8h.html">ps2gl/drawcontext.h</a>"</font>
00014 
<a name="l00015"></a><a class="code" href="classCClearEnv.html#a0">00015</a> <a class="code" href="classCClearEnv.html#a0">CClearEnv::CClearEnv</a>()<font class="keyword"></font>
00016 {
00017    pDrawEnv = <font class="keyword">new</font> GS::CDrawEnv( GS::kContext2 );
00018    pDrawEnv-&gt;SetDepthTestPassMode( GS::ZTest::kAlways );
00019 
00020    pSprite = <font class="keyword">new</font> CSprite( GS::kContext2, 0, 0, 0, 0 );
00021    pSprite-&gt;SetUseTexture( <font class="keyword">false</font> );
00022    <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> clearColor[4] = { 0, 0, 0, 0 };
00023    pSprite-&gt;SetColor( clearColor[0], clearColor[1], clearColor[2], clearColor[3] );
00024    pSprite-&gt;SetDepth( 0 );
00025 }
00026 
<a name="l00027"></a><a class="code" href="classCClearEnv.html#a1">00027</a> <a class="code" href="classCClearEnv.html#a1">CClearEnv::~CClearEnv</a>()<font class="keyword"></font>
00028 {
00029    <font class="keyword">delete</font> pDrawEnv;
00030    <font class="keyword">delete</font> pSprite;
00031 }
00032 
00033 <font class="keywordtype">void</font>
<a name="l00034"></a><a class="code" href="classCClearEnv.html#a2">00034</a> <a class="code" href="classCClearEnv.html#a2">CClearEnv::SetDimensions</a>( <font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height )<font class="keyword"></font>
00035 {
00036    pDrawEnv-&gt;SetFrameBufferDim( width, height );
00037    pSprite-&gt;SetVertices( 0, 0, width, height );
00038 }
00039 
00040 <font class="keywordtype">void</font>
<a name="l00041"></a><a class="code" href="classCClearEnv.html#a3">00041</a> <a class="code" href="classCClearEnv.html#a3">CClearEnv::SetFrameBufPsm</a>( GS::tPSM psm )<font class="keyword"></font>
00042 {
00043    pDrawEnv-&gt;SetFrameBufferPSM( psm );
00044 }
00045 
00046 <font class="keywordtype">void</font>
<a name="l00047"></a><a class="code" href="classCClearEnv.html#a4">00047</a> <a class="code" href="classCClearEnv.html#a4">CClearEnv::SetDepthBufPsm</a>( GS::tPSM psm )<font class="keyword"></font>
00048 {
00049    pDrawEnv-&gt;SetDepthBufferPSM( psm );
00050 }
00051 
00052 <font class="keywordtype">void</font>
<a name="l00053"></a><a class="code" href="classCClearEnv.html#a9">00053</a> <a class="code" href="classCClearEnv.html#a9">CClearEnv::ClearBuffers</a>( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> bitMask )<font class="keyword"></font>
00054 {
00055   <font class="keywordflow">if</font> ( bitMask &amp; <a class="code" href="gl_8h.html#a629">GL_DEPTH_BUFFER_BIT</a> )
00056     pDrawEnv-&gt;EnableDepthTest();
00057   <font class="keywordflow">else</font>
00058     pDrawEnv-&gt;DisableDepthTest();
00059 
00060   <font class="keywordflow">if</font> ( bitMask &amp; <a class="code" href="gl_8h.html#a635">GL_COLOR_BUFFER_BIT</a> )
00061     pDrawEnv-&gt;SetFrameBufferDrawMask( 0 );
00062   <font class="keywordflow">else</font>
00063     pDrawEnv-&gt;SetFrameBufferDrawMask( 0xffffffff );
00064 
00065   CVifSCDmaPacket &amp;packet = pGLContext-&gt;GetVif1Packet();
00066   pGLContext-&gt;AddingDrawEnvToPacket( (tU128*)pGLContext-&gt;GetVif1Packet().GetNextPtr() + 1 );
00067   pDrawEnv-&gt;SendSettings( packet );
00068   pSprite-&gt;Draw( packet );
00069 }
00070 
00071 <font class="comment">/********************************************</font>
00072  * C gl api
00073  */
00074 
<a name="l00075"></a><a class="code" href="clear_8cpp.html#a703">00075</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a703">glClearColor</a>( <a class="code" href="gl_8h.html#a699">GLclampf</a> red,
00076                    <a class="code" href="gl_8h.html#a699">GLclampf</a> green,
00077                    <a class="code" href="gl_8h.html#a699">GLclampf</a> blue,
00078                    <a class="code" href="gl_8h.html#a699">GLclampf</a> alpha )<font class="keyword"></font>
00079 {
00080    <a class="code" href="classCClearEnv.html">CClearEnv</a>&amp; clearEnv = pGLContext-&gt;GetImmDrawContext().GetClearEnv();
00081 
00082    <font class="keyword">using</font> <font class="keyword">namespace </font>Math;
00083    clearEnv.<a class="code" href="classCClearEnv.html#a7">SetClearColor</a>( Clamp(red, 0.0f, 1.0f),
00084                            Clamp(green, 0.0f, 1.0f),
00085                            Clamp(blue, 0.0f, 1.0f),
00086                            Clamp(alpha, 0.0f, 1.0f) );
00087 }
00088 
<a name="l00089"></a><a class="code" href="clear_8cpp.html#a745">00089</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a745">glClearDepth</a>( <a class="code" href="gl_8h.html#a701">GLclampd</a> depth )<font class="keyword"></font>
00090 {
00091    <a class="code" href="classCClearEnv.html">CClearEnv</a>&amp; clearEnv = pGLContext-&gt;GetImmDrawContext().GetClearEnv();
00092 
00093    clearEnv.<a class="code" href="classCClearEnv.html#a8">SetClearDepth</a>( (<font class="keywordtype">float</font>)depth );
00094 }
00095 
<a name="l00096"></a><a class="code" href="clear_8cpp.html#a704">00096</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a704">glClear</a>( <a class="code" href="gl_8h.html#a689">GLbitfield</a> mask )<font class="keyword"></font>
00097 {
00098    pGLContext-&gt;GetImmDrawContext().GetClearEnv().ClearBuffers( mask );
00099 }
00100 
</pre></div><hr><address><small>ps2gl version cvs</small></address>
