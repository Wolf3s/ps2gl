<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>drawcontext.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>drawcontext.cpp</h1><a href="drawcontext_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*        Copyright (C) 2000,2001,2002  Sony Computer Entertainment America</font>
00002           
00003           This file is subject to the terms and conditions of the GNU Lesser
00004           General Public License Version 2.1. See the file "COPYING" in the
00005           main directory of this archive for more details.                             */
00006 
00007 <font class="preprocessor">#include "ps2s/drawenv.h"</font>
00008 
00009 <font class="preprocessor">#include "<a class="code" href="ps2gl_8h.html">GL/ps2gl.h</a>"</font>
00010 
00011 <font class="preprocessor">#include "<a class="code" href="debug_8h.html">ps2gl/debug.h</a>"</font>
00012 <font class="preprocessor">#include "<a class="code" href="dlist_8h.html">ps2gl/dlist.h</a>"</font>
00013 <font class="preprocessor">#include "<a class="code" href="immgmanager_8h.html">ps2gl/immgmanager.h</a>"</font>
00014 <font class="preprocessor">#include "<a class="code" href="dlgmanager_8h.html">ps2gl/dlgmanager.h</a>"</font>
00015 <font class="preprocessor">#include "<a class="code" href="drawcontext_8h.html">ps2gl/drawcontext.h</a>"</font>
00016 <font class="preprocessor">#include "<a class="code" href="clear_8h.html">ps2gl/clear.h</a>"</font>
00017 <font class="preprocessor">#include "<a class="code" href="matrix_8h.html">ps2gl/matrix.h</a>"</font>
00018 
00019 <font class="comment">/********************************************</font>
00020  * CImmDrawContext methods
00021  */
00022 
<a name="l00023"></a><a class="code" href="classCImmDrawContext.html#a0">00023</a> <a class="code" href="classCImmDrawContext.html#a0">CImmDrawContext::CImmDrawContext</a>( <a class="code" href="classCGLContext.html">CGLContext</a> &amp;context )
00024    : <a class="code" href="classCDrawContext.html">CDrawContext</a>(context),
00025      DrawEnv(NULL),
00026      ClearEnv(NULL),
00027      FrameIsDblBuffered(false),
00028      DoSmoothShading(true),
00029      DoClipping(true),
00030      DoCullFace(false),
00031      CullFaceDir(1),
00032      RescaleNormals(false),
00033      BlendIsEnabled(false),
00034      AlphaTestIsEnabled(false),
00035      DrawInterlaced(true),
00036      PolyMode(<a class="code" href="gl_8h.html#a81">GL_FILL</a>),
00037      IsVertexXformValid(false),
00038      Width(0), Height(0)
00039 {
00040    GSScale.set_identity();
00041 
00042    ClearEnv = <font class="keyword">new</font> <a class="code" href="classCClearEnv.html">CClearEnv</a>;
00043 
00044    DrawEnv = <font class="keyword">new</font> GS::CDrawEnv( GS::kContext1 );
00045    DrawEnv-&gt;SetDepthTestPassMode( GS::ZTest::kGEqual );
00046    <font class="keyword">using</font> <font class="keyword">namespace </font>GS::ABlend;
00047    DrawEnv-&gt;SetAlphaBlendFunc( kSourceRGB, kDestRGB, kSourceAlpha, kDestRGB, 0x80 );
00048    DrawEnv-&gt;SetFogColor( 255, 255, 255 );
00049 
00050    <font class="comment">// alpha test</font>
00051    DrawEnv-&gt;DisableAlphaTest();
00052    DrawEnv-&gt;SetAlphaRefVal( 0 );
00053    DrawEnv-&gt;SetAlphaTestPassMode( GS::ATest::kAlways );
00054 }
00055 
<a name="l00056"></a><a class="code" href="classCImmDrawContext.html#a1">00056</a> <a class="code" href="classCImmDrawContext.html">CImmDrawContext</a>::~<a class="code" href="classCImmDrawContext.html">CImmDrawContext</a>()
00057 {
00058    <font class="comment">// don't delete the frame mem areas -- they are created/destroyed by</font>
00059    <font class="comment">// the app</font>
00060 
00061    <font class="keyword">delete</font> ClearEnv;
00062    <font class="keyword">delete</font> DrawEnv;
00063 }
00064 
00065 <font class="keywordtype">void</font>
<a name="l00066"></a><a class="code" href="classCImmDrawContext.html#a32">00066</a> <a class="code" href="classCImmDrawContext.html#a32">CImmDrawContext::SetDrawBuffers</a>( <font class="keywordtype">bool</font> interlaced,
00067                                  GS::CMemArea *frame0Mem, GS::CMemArea *frame1Mem,
00068                                  GS::CMemArea *depthMem )<font class="keyword"></font>
00069 {
00070    Frame0Mem = frame0Mem;
00071    Frame1Mem = frame1Mem;
00072    ZBufMem = depthMem;
00073 
00074    DrawInterlaced = interlaced;
00075    FrameIsDblBuffered = ( frame0Mem &amp;&amp; frame1Mem );
00076 
00077    <font class="comment">// see displaycontext for a comment on this..</font>
00078    CurFrameMem = Frame0Mem;
00079    LastFrameMem = Frame1Mem;
00080 
00081    <font class="keywordtype">int</font> width = frame0Mem-&gt;GetWidth(), height = frame0Mem-&gt;GetHeight();
00082    Width = width;
00083    Height = height;
00084 
00085    <font class="comment">// get max depth buffer value</font>
00086 
00087    <font class="keywordtype">int</font> depthPsm = GS::kPsmz24;
00088    <font class="keywordflow">if</font> ( depthMem ) depthPsm = depthMem-&gt;GetPixFormat();
00089    DepthBits = 0;
00090    <font class="keywordflow">if</font> ( depthPsm == GS::kPsmz24 ) DepthBits = 24;
00091    <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( depthPsm == GS::kPsmz32 ) DepthBits = 28; <font class="comment">// for fog</font>
00092    <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( depthPsm == GS::kPsmz16 ) DepthBits = 16;
00093    <font class="keywordflow">else</font> { mError( <font class="stringliteral">"Unknown depth buffer format"</font> ); }
00094    <font class="keywordtype">int</font> maxDepthValue = (1 &lt;&lt; DepthBits) - 1;
00095 
00096    <font class="comment">// projection xform</font>
00097 
00098    <font class="comment">// -1 here flips mapping to: far_clip -&gt; -1, near_clip -&gt; 1</font>
00099    GSScale.set_scale( cpu_vec_xyz(width/2.0f, -1 * height/2.0f, -1 * (<font class="keywordtype">float</font>)maxDepthValue/2.0f) );
00100    <a class="code" href="classCImmDrawContext.html#a6">SetVertexXformValid</a>(<font class="keyword">false</font>);
00101 
00102    <font class="comment">// clear environment</font>
00103 
00104    ClearEnv-&gt;<a class="code" href="classCClearEnv.html#a2">SetDimensions</a>( width, height );
00105    ClearEnv-&gt;<a class="code" href="classCClearEnv.html#a5">SetFrameBufAddr</a>( frame0Mem-&gt;GetWordAddr() );
00106    ClearEnv-&gt;<a class="code" href="classCClearEnv.html#a3">SetFrameBufPsm</a>( frame0Mem-&gt;GetPixFormat() );
00107    <font class="keywordflow">if</font> ( ZBufMem ) {
00108       ClearEnv-&gt;<a class="code" href="classCClearEnv.html#a6">SetDepthBufAddr</a>( ZBufMem-&gt;GetWordAddr() );
00109       ClearEnv-&gt;<a class="code" href="classCClearEnv.html#a4">SetDepthBufPsm</a>( ZBufMem-&gt;GetPixFormat() );
00110    }
00111 
00112    <font class="comment">// draw environment</font>
00113 
00114    DrawEnv-&gt;SetFrameBufferAddr( CurFrameMem-&gt;GetWordAddr() );
00115    DrawEnv-&gt;SetFrameBufferDim( width, height );
00116    DrawEnv-&gt;CalculateClippedFBXYOffsets( GS::kDontAddHalfPixel );
00117    DrawEnv-&gt;SetFrameBufferPSM( frame0Mem-&gt;GetPixFormat() );
00118 
00119    <font class="comment">// DrawEnv-&gt;SetScissorArea( 0, height * 0.25f, width, height * 0.25f );</font>
00120 
00121    <font class="keywordflow">if</font> ( ZBufMem ) {
00122       DrawEnv-&gt;EnableDepthTest();
00123       DrawEnv-&gt;SetDepthBufferAddr( ZBufMem-&gt;GetWordAddr() );
00124       DrawEnv-&gt;SetDepthBufferPSM( ZBufMem-&gt;GetPixFormat() );
00125    }
00126    <font class="keywordflow">else</font>
00127       DrawEnv-&gt;DisableDepthTest();
00128 
00129    GLContext.DrawBufferChanged();
00130 }
00131 
00132 <font class="keywordtype">void</font>
<a name="l00133"></a><a class="code" href="classCImmDrawContext.html#a3">00133</a> <a class="code" href="classCImmDrawContext.html#a3">CImmDrawContext::SwapBuffers</a>( <font class="keywordtype">bool</font> fieldIsEven )<font class="keyword"></font>
00134 {
00135    <font class="comment">// flip frame buffer ptrs</font>
00136    <font class="keywordflow">if</font> ( FrameIsDblBuffered ) {
00137       GS::CMemArea* temp = CurFrameMem;
00138       CurFrameMem = LastFrameMem;
00139       LastFrameMem = temp;
00140 
00141       <font class="comment">// clear the new frame</font>
00142       ClearEnv-&gt;<a class="code" href="classCClearEnv.html#a5">SetFrameBufAddr</a>( CurFrameMem-&gt;GetWordAddr() );
00143 
00144       <font class="comment">// draw to the new frame</font>
00145       DrawEnv-&gt;SetFrameBufferAddr( CurFrameMem-&gt;GetWordAddr() );
00146 
00147       GLContext.DrawEnvChanged();
00148    }
00149 
00150    <font class="keywordflow">if</font> ( DrawInterlaced ) {
00151       <font class="comment">// add a half-pixel offset if the frame we're going to build on the core will</font>
00152       <font class="comment">// be displayed in an odd field</font>
00153       DrawEnv-&gt;CalculateClippedFBXYOffsets( ! fieldIsEven );
00154 
00155       GLContext.DrawEnvChanged();
00156    }
00157 }
00158 
00159 <font class="keyword">const</font> cpu_mat_44&amp;
<a name="l00160"></a><a class="code" href="classCImmDrawContext.html#a5">00160</a> <a class="code" href="classCImmDrawContext.html#a5">CImmDrawContext::GetVertexXform</a>()<font class="keyword"></font>
00161 {
00162    <font class="keywordflow">if</font> ( ! IsVertexXformValid ) {
00163       IsVertexXformValid = <font class="keyword">true</font>;
00164       VertexXform = (GLContext.GetProjectionStack().GetTop()
00165                      * GLContext.GetModelViewStack().GetTop());
00166       VertexXform = GSScale * VertexXform;
00167    }
00168 
00169    <font class="keywordflow">return</font> VertexXform;
00170 }
00171 
00172 <font class="keywordtype">void</font>
<a name="l00173"></a><a class="code" href="classCImmDrawContext.html#a14">00173</a> <a class="code" href="classCImmDrawContext.html#a14">CImmDrawContext::SetDoSmoothShading</a>( <font class="keywordtype">bool</font> yesNo )<font class="keyword"></font>
00174 {
00175    <font class="keywordflow">if</font> ( DoSmoothShading != yesNo ) {
00176       DoSmoothShading = yesNo;
00177       GLContext.ShadingChanged();
00178    }
00179 }
00180 
00181 <font class="keywordtype">void</font>
<a name="l00182"></a><a class="code" href="classCImmDrawContext.html#a16">00182</a> <a class="code" href="classCImmDrawContext.html#a16">CImmDrawContext::SetDoClipping</a>( <font class="keywordtype">bool</font> clip )<font class="keyword"></font>
00183 {
00184    <font class="keywordflow">if</font> ( DoClipping != clip ) {
00185       DoClipping = clip;
00186       GLContext.ClippingEnabledChanged();
00187       GLContext.GetImmGeomManager().GetRendererManager().ClippingEnabledChanged(clip);
00188    }
00189 }
00190          
00191 <font class="keywordtype">void</font>
<a name="l00192"></a><a class="code" href="classCImmDrawContext.html#a18">00192</a> <a class="code" href="classCImmDrawContext.html#a18">CImmDrawContext::SetDoCullFace</a>( <font class="keywordtype">bool</font> cull )<font class="keyword"></font>
00193 {
00194    <font class="keywordflow">if</font> ( DoCullFace != cull ) {
00195       DoCullFace = cull;
00196       GLContext.CullFaceEnabledChanged();
00197       GLContext.GetImmGeomManager().GetRendererManager().CullFaceEnabledChanged(cull);
00198    }
00199 }
00200          
00201 <font class="keywordtype">void</font>
<a name="l00202"></a><a class="code" href="classCImmDrawContext.html#a20">00202</a> <a class="code" href="classCImmDrawContext.html#a20">CImmDrawContext::SetCullFaceDir</a>( <font class="keywordtype">int</font> direction )<font class="keyword"></font>
00203 {
00204    <font class="keywordflow">if</font> ( CullFaceDir != direction ) {
00205       CullFaceDir = direction;
00206       GLContext.CullFaceDirChanged();
00207    }
00208 }
00209 
00210 <font class="keywordtype">void</font>
<a name="l00211"></a><a class="code" href="classCImmDrawContext.html#a22">00211</a> <a class="code" href="classCImmDrawContext.html#a22">CImmDrawContext::SetBlendEnabled</a>( <font class="keywordtype">bool</font> enabled )<font class="keyword"></font>
00212 {
00213    <font class="keywordflow">if</font> ( BlendIsEnabled != enabled ) {
00214       BlendIsEnabled = enabled;
00215       GLContext.BlendEnabledChanged();
00216    }
00217 }
00218       
00219 <font class="keywordtype">void</font>
<a name="l00220"></a><a class="code" href="classCImmDrawContext.html#a31">00220</a> <a class="code" href="classCImmDrawContext.html#a31">CImmDrawContext::SetRescaleNormals</a>( <font class="keywordtype">bool</font> rescale )<font class="keyword"></font>
00221 {
00222    <font class="keywordflow">if</font> ( RescaleNormals != rescale ) {
00223       RescaleNormals = rescale;
00224       GLContext.LightPropChanged();
00225    }
00226 }
00227 
00228 <font class="keywordtype">void</font>
<a name="l00229"></a><a class="code" href="classCImmDrawContext.html#a26">00229</a> <a class="code" href="classCImmDrawContext.html#a26">CImmDrawContext::SetDepthWriteEnabled</a>( <font class="keywordtype">bool</font> enabled )<font class="keyword"></font>
00230 {
00231    DrawEnv-&gt;SetDepthWriteEnabled(enabled);
00232    GLContext.DepthWriteEnabledChanged();
00233 }
00234 
00235 <font class="keywordtype">void</font>
<a name="l00236"></a><a class="code" href="classCImmDrawContext.html#a27">00236</a> <a class="code" href="classCImmDrawContext.html#a27">CImmDrawContext::SetFrameBufferDrawMask</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> mask)<font class="keyword"></font>
00237 {
00238    DrawEnv-&gt;SetFrameBufferDrawMask(mask);
00239    GLContext.FrameBufferDrawMaskChanged(); 
00240 }
00241 
00242 <font class="keywordtype">void</font>
<a name="l00243"></a><a class="code" href="classCImmDrawContext.html#a29">00243</a> <a class="code" href="classCImmDrawContext.html#a29">CImmDrawContext::SetPolygonMode</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> mode )<font class="keyword"></font>
00244 {
00245    <font class="keywordflow">if</font> ( PolyMode != mode ) {
00246       PolyMode = mode;
00247       GLContext.PolyModeChanged();
00248    }
00249 }
00250 
00251 <font class="keywordtype">void</font> 
<a name="l00252"></a><a class="code" href="classCImmDrawContext.html#a24">00252</a> <a class="code" href="classCImmDrawContext.html#a24">CImmDrawContext::SetAlphaTestEnabled</a>( <font class="keywordtype">bool</font> enabled )<font class="keyword"> </font>
00253 {
00254    <font class="keywordflow">if</font> ( AlphaTestIsEnabled != enabled ) {
00255       AlphaTestIsEnabled = enabled;
00256 
00257       <font class="keywordflow">if</font> (enabled) {
00258           DrawEnv-&gt;EnableAlphaTest();
00259       } <font class="keywordflow">else</font> {
00260           DrawEnv-&gt;DisableAlphaTest();
00261       }
00262 
00263       GLContext.AlphaTestEnabledChanged();
00264    }
00265 }
00266 
00267 <font class="keywordtype">void</font>
<a name="l00268"></a><a class="code" href="classCImmDrawContext.html#a25">00268</a> <a class="code" href="classCImmDrawContext.html#a25">CImmDrawContext::SetInterlacingOffset</a>( <font class="keywordtype">float</font> yPixels )<font class="keyword"></font>
00269 {
00270    <font class="keywordflow">if</font> ( DrawEnv-&gt;GetInterlacedPixelOffset() != yPixels ) {
00271       DrawEnv-&gt;SetInterlacedPixelOffset( yPixels );
00272       <font class="keywordtype">bool</font> offset = (DrawInterlaced &amp;&amp; GLContext.GetCurrentFieldIsEven());
00273       DrawEnv-&gt;CalculateClippedFBXYOffsets( offset );
00274 
00275       GLContext.DrawEnvChanged();
00276    }
00277 }
00278 
00279 <font class="comment">// I hate to do it, but...</font>
<a name="l00280"></a><a class="code" href="drawcontext_8cpp.html#a0">00280</a> <font class="preprocessor">#define mCombineBlendFactors( _src, _dest )             \</font>
00281    ((unsigned int)(_src) &lt;&lt; 16) | (unsigned int)(_dest)
00282 
00283 <font class="keywordtype">void</font>
<a name="l00284"></a><a class="code" href="classCImmDrawContext.html#a11">00284</a> <a class="code" href="classCImmDrawContext.html#a11">CImmDrawContext::SetBlendMode</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> source, <a class="code" href="gl_8h.html#a687">GLenum</a> dest )<font class="keyword"></font>
00285 {
00286    <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> blendFactor = <a class="code" href="drawcontext_8cpp.html#a0">mCombineBlendFactors</a>(source, dest);
00287 
00288    <font class="keywordflow">switch</font> (blendFactor) {
00289       <font class="keywordflow">case</font> <a class="code" href="drawcontext_8cpp.html#a0">mCombineBlendFactors</a>( <a class="code" href="gl_8h.html#a180">GL_SRC_ALPHA</a>, <a class="code" href="gl_8h.html#a181">GL_ONE_MINUS_SRC_ALPHA</a> ):
00290          <font class="keyword">using</font> <font class="keyword">namespace </font>GS::ABlend;
00291          DrawEnv-&gt;SetAlphaBlendFunc( kSourceRGB, kDestRGB, kSourceAlpha, kDestRGB, 0x80 );
00292          GLContext.BlendModeChanged();
00293          break;
00294       case <a class="code" href="drawcontext_8cpp.html#a0">mCombineBlendFactors</a>( <a class="code" href="gl_8h.html#a180">GL_SRC_ALPHA</a>, <a class="code" href="gl_8h.html#a175">GL_ONE</a> ):
00295          DrawEnv-&gt;SetAlphaBlendFunc( kSourceRGB, kZero, kSourceAlpha, kDestRGB, 0x80 );
00296          GLContext.BlendModeChanged();
00297          break;
00298          <font class="comment">// the following is actually subtractive blending, which</font>
00299          <font class="comment">// should be GL_MINUS_ALPHA, GL_ONE but there is no minus alpha in GL</font>
00300      case <a class="code" href="drawcontext_8cpp.html#a0">mCombineBlendFactors</a>( <a class="code" href="gl_8h.html#a181">GL_ONE_MINUS_SRC_ALPHA</a>, <a class="code" href="gl_8h.html#a175">GL_ONE</a> ):
00301          DrawEnv-&gt;SetAlphaBlendFunc( kZero, kSourceRGB, kSourceAlpha, kDestRGB, 0x80 );
00302          GLContext.BlendModeChanged();
00303          break;
00304       default:
00305          <a class="code" href="debug_8h.html#a1">mNotImplemented</a>( "alpha blending mode: source = %d, dest = %d", source, dest );
00306    }
00307 }
00308 
00309 #undef <a class="code" href="drawcontext_8cpp.html#a0">mCombineBlendFactors</a>
00310 
00311 void 
<a name="l00312"></a><a class="code" href="classCImmDrawContext.html#a12">00312</a> <a class="code" href="classCImmDrawContext.html">CImmDrawContext</a>::SetAlphaFunc( <a class="code" href="gl_8h.html#a687">GLenum</a> func, <a class="code" href="gl_8h.html#a699">GLclampf</a> ref )
00313 {
00314    GS::tAlphaTestPassMode ePassMode;
00315        
00316    <font class="keywordflow">switch</font>(func) {
00317       <font class="keywordflow">case</font> <a class="code" href="gl_8h.html#a103">GL_NEVER</a>:
00318          ePassMode = GS::ATest::kNever;
00319          <font class="keywordflow">break</font>;
00320 
00321       <font class="keywordflow">case</font> <a class="code" href="gl_8h.html#a104">GL_LESS</a>:
00322          ePassMode = GS::ATest::kLess;
00323          <font class="keywordflow">break</font>;
00324 
00325       <font class="keywordflow">case</font> <a class="code" href="gl_8h.html#a105">GL_EQUAL</a>:
00326          ePassMode = GS::ATest::kEqual;
00327          <font class="keywordflow">break</font>;
00328 
00329       <font class="keywordflow">case</font> <a class="code" href="gl_8h.html#a106">GL_LEQUAL</a>:
00330          ePassMode = GS::ATest::kLEqual;
00331          <font class="keywordflow">break</font>;
00332 
00333       <font class="keywordflow">case</font> <a class="code" href="gl_8h.html#a107">GL_GREATER</a>:
00334          ePassMode = GS::ATest::kGreater;
00335          <font class="keywordflow">break</font>;
00336 
00337       <font class="keywordflow">case</font> <a class="code" href="gl_8h.html#a108">GL_NOTEQUAL</a>:
00338          ePassMode = GS::ATest::kNotEqual;
00339          <font class="keywordflow">break</font>;
00340 
00341       <font class="keywordflow">case</font> <a class="code" href="gl_8h.html#a109">GL_GEQUAL</a>:
00342          ePassMode = GS::ATest::kGEqual;
00343          <font class="keywordflow">break</font>;
00344 
00345       <font class="keywordflow">case</font> <a class="code" href="gl_8h.html#a110">GL_ALWAYS</a>:
00346          ePassMode = GS::ATest::kAlways;
00347          <font class="keywordflow">break</font>;
00348 
00349       <font class="keywordflow">default</font>:
00350          mError(<font class="stringliteral">"Unknown alpha test function"</font>);
00351          <font class="keywordflow">return</font>;
00352    }
00353 
00354    DrawEnv-&gt;SetAlphaRefVal((<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>)(ref * 0xff));
00355    DrawEnv-&gt;SetAlphaTestPassMode(ePassMode);
00356    DrawEnv-&gt;SetAlphaTestFailAction(GS::ATest::kKeep);
00357 
00358    GLContext.AlphaTestFuncChanged();
00359 }
00360 
00361 <font class="comment">/********************************************</font>
00362  * CDListDrawContext methods
00363  */
00364 
<a name="l00365"></a><a class="code" href="classCSetDrawBuffers.html">00365</a> <font class="keyword">class </font><a class="code" href="classCSetDrawBuffers.html">CSetDrawBuffers</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00366       GS::CMemArea      *Frame0, *Frame1, *Depth;
00367       <font class="keywordtype">bool</font>              Interlaced;
00368    <font class="keyword">public</font>:
<a name="l00369"></a><a class="code" href="classCSetDrawBuffers.html#a0">00369</a>       CSetDrawBuffers( <font class="keywordtype">bool</font> inter, GS::CMemArea *frame0, GS::CMemArea *frame1, GS::CMemArea *depth )
00370          : Frame0(frame0), Frame1(frame1), Depth(depth), Interlaced(inter) {}
<a name="l00371"></a><a class="code" href="classCSetDrawBuffers.html#a1">00371</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* Play()<font class="keyword"> </font>{
00372          pGLContext-&gt;GetImmDrawContext().SetDrawBuffers( Interlaced, Frame0, Frame1, Depth );
00373          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00374       }
00375 };
00376 
00377 <font class="keywordtype">void</font>
<a name="l00378"></a><a class="code" href="classCDListDrawContext.html#a14">00378</a> <a class="code" href="classCDListDrawContext.html#a14">CDListDrawContext::SetDrawBuffers</a>( <font class="keywordtype">bool</font> interlaced,
00379                                    GS::CMemArea *frame0Mem, GS::CMemArea *frame1Mem,
00380                                    GS::CMemArea *depthMem )<font class="keyword"></font>
00381 {
00382    GLContext.GetDListGeomManager().Flush();
00383 
00384    GLContext.GetDListManager().GetOpenDList() += CSetDrawBuffers(interlaced,
00385                                                                  frame0Mem, frame1Mem,
00386                                                                  depthMem);
00387    GLContext.DrawBufferChanged();
00388 }
00389 
<a name="l00390"></a><a class="code" href="classCSetDoSmoothShadingCmd.html">00390</a> <font class="keyword">class </font><a class="code" href="classCSetDoSmoothShadingCmd.html">CSetDoSmoothShadingCmd</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00391       <font class="keywordtype">bool</font>      DoSS;
00392    <font class="keyword">public</font>:
<a name="l00393"></a><a class="code" href="classCSetDoSmoothShadingCmd.html#a0">00393</a>       <a class="code" href="classCSetDoSmoothShadingCmd.html#a0">CSetDoSmoothShadingCmd</a>( <font class="keywordtype">bool</font> yesNo ) : DoSS(yesNo) {}
<a name="l00394"></a><a class="code" href="classCSetDoSmoothShadingCmd.html#a1">00394</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00395          pGLContext-&gt;GetImmDrawContext().SetDoSmoothShading( DoSS );
00396          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>( <font class="keyword">this</font> );
00397       }
00398 };
00399 
00400 <font class="keywordtype">void</font>
<a name="l00401"></a><a class="code" href="classCDListDrawContext.html#a3">00401</a> <a class="code" href="classCDListDrawContext.html#a3">CDListDrawContext::SetDoSmoothShading</a>( <font class="keywordtype">bool</font> yesNo )<font class="keyword"></font>
00402 {
00403    GLContext.GetDListGeomManager().Flush();
00404 
00405    GLContext.GetDListManager().GetOpenDList() += CSetDoSmoothShadingCmd( yesNo );
00406    GLContext.ShadingChanged();
00407 }
00408 
<a name="l00409"></a><a class="code" href="classCSetDoClippingCmd.html">00409</a> <font class="keyword">class </font><a class="code" href="classCSetDoClippingCmd.html">CSetDoClippingCmd</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00410       <font class="keywordtype">bool</font>      DoClip;
00411    <font class="keyword">public</font>:
<a name="l00412"></a><a class="code" href="classCSetDoClippingCmd.html#a0">00412</a>       <a class="code" href="classCSetDoClippingCmd.html#a0">CSetDoClippingCmd</a>(<font class="keywordtype">bool</font> clip) : DoClip(clip) {}
<a name="l00413"></a><a class="code" href="classCSetDoClippingCmd.html#a1">00413</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00414          pGLContext-&gt;GetImmDrawContext().SetDoClipping(DoClip);
00415          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00416       }
00417 };
00418 
00419 <font class="keywordtype">void</font>
<a name="l00420"></a><a class="code" href="classCDListDrawContext.html#a4">00420</a> <a class="code" href="classCDListDrawContext.html#a4">CDListDrawContext::SetDoClipping</a>( <font class="keywordtype">bool</font> clip )<font class="keyword"></font>
00421 {
00422    GLContext.GetDListGeomManager().Flush();
00423 
00424    GLContext.GetDListManager().GetOpenDList() += CSetDoClippingCmd(clip);
00425    GLContext.ClippingEnabledChanged();
00426 }
00427 
<a name="l00428"></a><a class="code" href="classCSetDoCullFaceCmd.html">00428</a> <font class="keyword">class </font><a class="code" href="classCSetDoCullFaceCmd.html">CSetDoCullFaceCmd</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00429       <font class="keywordtype">bool</font>      DoCull;
00430    <font class="keyword">public</font>:
<a name="l00431"></a><a class="code" href="classCSetDoCullFaceCmd.html#a0">00431</a>       <a class="code" href="classCSetDoCullFaceCmd.html#a0">CSetDoCullFaceCmd</a>(<font class="keywordtype">bool</font> cull) : DoCull(cull) {}
<a name="l00432"></a><a class="code" href="classCSetDoCullFaceCmd.html#a1">00432</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00433          pGLContext-&gt;GetImmDrawContext().SetDoCullFace(DoCull);
00434          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00435       }
00436 };
00437 
00438 <font class="keywordtype">void</font>
<a name="l00439"></a><a class="code" href="classCDListDrawContext.html#a5">00439</a> <a class="code" href="classCDListDrawContext.html#a5">CDListDrawContext::SetDoCullFace</a>( <font class="keywordtype">bool</font> cull )<font class="keyword"></font>
00440 {
00441    GLContext.GetDListGeomManager().Flush();
00442 
00443    GLContext.GetDListManager().GetOpenDList() += CSetDoCullFaceCmd(cull);
00444    GLContext.CullFaceEnabledChanged();
00445 }
00446 
<a name="l00447"></a><a class="code" href="classCSetCullFaceDir.html">00447</a> <font class="keyword">class </font><a class="code" href="classCSetCullFaceDir.html">CSetCullFaceDir</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00448       <font class="keywordtype">int</font>       CullDir;
00449    <font class="keyword">public</font>:
<a name="l00450"></a><a class="code" href="classCSetCullFaceDir.html#a0">00450</a>       <a class="code" href="classCSetCullFaceDir.html#a0">CSetCullFaceDir</a>(<font class="keywordtype">int</font> dir) : CullDir(dir) {}
<a name="l00451"></a><a class="code" href="classCSetCullFaceDir.html#a1">00451</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00452          pGLContext-&gt;GetImmDrawContext().SetCullFaceDir(CullDir);
00453          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00454       }
00455 };
00456 
00457 <font class="keywordtype">void</font>
<a name="l00458"></a><a class="code" href="classCDListDrawContext.html#a6">00458</a> <a class="code" href="classCDListDrawContext.html#a6">CDListDrawContext::SetCullFaceDir</a>( <font class="keywordtype">int</font> direction )<font class="keyword"></font>
00459 {
00460    GLContext.GetDListGeomManager().Flush();
00461 
00462    GLContext.GetDListManager().GetOpenDList() += CSetCullFaceDir(direction);
00463    GLContext.CullFaceDirChanged();
00464 }
00465 
<a name="l00466"></a><a class="code" href="classCSetBlendEnabledCmd.html">00466</a> <font class="keyword">class </font><a class="code" href="classCSetBlendEnabledCmd.html">CSetBlendEnabledCmd</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00467       <font class="keywordtype">bool</font>      Enabled;
00468    <font class="keyword">public</font>:
<a name="l00469"></a><a class="code" href="classCSetBlendEnabledCmd.html#a0">00469</a>       <a class="code" href="classCSetBlendEnabledCmd.html#a0">CSetBlendEnabledCmd</a>( <font class="keywordtype">bool</font> enabled ) : Enabled(enabled) {}
<a name="l00470"></a><a class="code" href="classCSetBlendEnabledCmd.html#a1">00470</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00471          pGLContext-&gt;GetImmDrawContext().SetBlendEnabled(Enabled);
00472          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00473       }
00474 };
00475 
00476 <font class="keywordtype">void</font>
<a name="l00477"></a><a class="code" href="classCDListDrawContext.html#a8">00477</a> <a class="code" href="classCDListDrawContext.html#a8">CDListDrawContext::SetBlendEnabled</a>( <font class="keywordtype">bool</font> enabled )<font class="keyword"></font>
00478 {
00479    GLContext.GetDListGeomManager().Flush();
00480 
00481    GLContext.GetDListManager().GetOpenDList() += CSetBlendEnabledCmd(enabled);
00482    GLContext.BlendEnabledChanged();
00483 }
00484 
<a name="l00485"></a><a class="code" href="classCSetAlphaTestEnabledCmd.html">00485</a> <font class="keyword">class </font><a class="code" href="classCSetAlphaTestEnabledCmd.html">CSetAlphaTestEnabledCmd</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00486       <font class="keywordtype">bool</font>      Enabled;
00487    <font class="keyword">public</font>:
<a name="l00488"></a><a class="code" href="classCSetAlphaTestEnabledCmd.html#a0">00488</a>       <a class="code" href="classCSetAlphaTestEnabledCmd.html#a0">CSetAlphaTestEnabledCmd</a>( <font class="keywordtype">bool</font> enabled ) : Enabled(enabled) {}
<a name="l00489"></a><a class="code" href="classCSetAlphaTestEnabledCmd.html#a1">00489</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00490          pGLContext-&gt;GetImmDrawContext().SetAlphaTestEnabled(Enabled);
00491          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00492       }
00493 };
00494 
00495 <font class="keywordtype">void</font>
<a name="l00496"></a><a class="code" href="classCDListDrawContext.html#a9">00496</a> <a class="code" href="classCDListDrawContext.html#a9">CDListDrawContext::SetAlphaTestEnabled</a>( <font class="keywordtype">bool</font> enabled )<font class="keyword"></font>
00497 {
00498    GLContext.GetDListGeomManager().Flush();
00499 
00500    GLContext.GetDListManager().GetOpenDList() += CSetAlphaTestEnabledCmd(enabled);
00501    GLContext.AlphaTestEnabledChanged();
00502 }
00503 
<a name="l00504"></a><a class="code" href="classCSetInterlacingOffsetCmd.html">00504</a> <font class="keyword">class </font><a class="code" href="classCSetInterlacingOffsetCmd.html">CSetInterlacingOffsetCmd</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00505       <font class="keywordtype">float</font>     Offset;
00506    <font class="keyword">public</font>:
<a name="l00507"></a><a class="code" href="classCSetInterlacingOffsetCmd.html#a0">00507</a>       <a class="code" href="classCSetInterlacingOffsetCmd.html#a0">CSetInterlacingOffsetCmd</a>( <font class="keywordtype">float</font> offset ) : Offset(offset) {}
<a name="l00508"></a><a class="code" href="classCSetInterlacingOffsetCmd.html#a1">00508</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00509          pGLContext-&gt;GetImmDrawContext().SetInterlacingOffset(Offset);
00510          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00511       }
00512 };
00513 
00514 <font class="keywordtype">void</font>
<a name="l00515"></a><a class="code" href="classCDListDrawContext.html#a10">00515</a> <a class="code" href="classCDListDrawContext.html#a10">CDListDrawContext::SetInterlacingOffset</a>( <font class="keywordtype">float</font> yPixels )<font class="keyword"></font>
00516 {
00517    GLContext.GetDListGeomManager().Flush();
00518 
00519    GLContext.GetDListManager().GetOpenDList() += CSetInterlacingOffsetCmd(yPixels);
00520    GLContext.DrawEnvChanged();
00521 }
00522 
<a name="l00523"></a><a class="code" href="classCSetAlphaFuncCmd.html">00523</a> <font class="keyword">class </font><a class="code" href="classCSetAlphaFuncCmd.html">CSetAlphaFuncCmd</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00524     <a class="code" href="gl_8h.html#a687">GLenum</a>   Func;
00525     <a class="code" href="gl_8h.html#a699">GLclampf</a> Ref;
00526 <font class="keyword">public</font>:
<a name="l00527"></a><a class="code" href="classCSetAlphaFuncCmd.html#a0">00527</a>     <a class="code" href="classCSetAlphaFuncCmd.html#a0">CSetAlphaFuncCmd</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> func, <a class="code" href="gl_8h.html#a699">GLclampf</a> ref ) : Func(func), Ref(ref) {}
<a name="l00528"></a><a class="code" href="classCSetAlphaFuncCmd.html#a1">00528</a>     <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00529         pGLContext-&gt;GetImmDrawContext().SetAlphaFunc(Func, Ref);
00530         <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00531     }
00532 };
00533 
00534 <font class="keywordtype">void</font> 
<a name="l00535"></a><a class="code" href="classCDListDrawContext.html#a2">00535</a> <a class="code" href="classCDListDrawContext.html#a2">CDListDrawContext::SetAlphaFunc</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> func, <a class="code" href="gl_8h.html#a699">GLclampf</a> ref )<font class="keyword"></font>
00536 {
00537     GLContext.GetDListGeomManager().Flush();
00538     
00539     GLContext.GetDListManager().GetOpenDList() += CSetAlphaFuncCmd(func, ref);
00540     GLContext.AlphaTestFuncChanged();
00541 }
00542 
<a name="l00543"></a><a class="code" href="classCSetRescaleNormalsCmd.html">00543</a> <font class="keyword">class </font><a class="code" href="classCSetRescaleNormalsCmd.html">CSetRescaleNormalsCmd</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00544       <font class="keywordtype">bool</font>      Rescale;
00545    <font class="keyword">public</font>:
<a name="l00546"></a><a class="code" href="classCSetRescaleNormalsCmd.html#a0">00546</a>       <a class="code" href="classCSetRescaleNormalsCmd.html#a0">CSetRescaleNormalsCmd</a>( <font class="keywordtype">bool</font> rescale ) : Rescale(rescale) {}
<a name="l00547"></a><a class="code" href="classCSetRescaleNormalsCmd.html#a1">00547</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00548          pGLContext-&gt;GetDrawContext().SetRescaleNormals(Rescale);
00549          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00550       }
00551 };
00552 
00553 <font class="keywordtype">void</font>
<a name="l00554"></a><a class="code" href="classCDListDrawContext.html#a7">00554</a> <a class="code" href="classCDListDrawContext.html#a7">CDListDrawContext::SetRescaleNormals</a>( <font class="keywordtype">bool</font> rescale )<font class="keyword"></font>
00555 {
00556    GLContext.GetDListGeomManager().Flush();
00557 
00558    GLContext.GetDListManager().GetOpenDList() += CSetRescaleNormalsCmd(rescale);
00559    GLContext.LightPropChanged();
00560 }
00561 
<a name="l00562"></a><a class="code" href="classCSetBlendMode.html">00562</a> <font class="keyword">class </font><a class="code" href="classCSetBlendMode.html">CSetBlendMode</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00563       <a class="code" href="gl_8h.html#a687">GLenum</a>    Source, Dest;
00564    <font class="keyword">public</font>:
<a name="l00565"></a><a class="code" href="classCSetBlendMode.html#a0">00565</a>       <a class="code" href="classCSetBlendMode.html#a0">CSetBlendMode</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> s, <a class="code" href="gl_8h.html#a687">GLenum</a> d ) : Source(s), Dest(d) {}
<a name="l00566"></a><a class="code" href="classCSetBlendMode.html#a1">00566</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00567          pGLContext-&gt;GetImmDrawContext().SetBlendMode( Source, Dest );
00568          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00569       }
00570 };
00571 
00572 <font class="keywordtype">void</font>
<a name="l00573"></a><a class="code" href="classCDListDrawContext.html#a1">00573</a> <a class="code" href="classCDListDrawContext.html#a1">CDListDrawContext::SetBlendMode</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> source, <a class="code" href="gl_8h.html#a687">GLenum</a> dest )<font class="keyword"></font>
00574 {
00575    GLContext.GetDListGeomManager().Flush();
00576 
00577    GLContext.GetDListManager().GetOpenDList() += CSetBlendMode(source, dest);
00578    GLContext.BlendModeChanged();
00579 }
00580 
<a name="l00581"></a><a class="code" href="classCSetDepthWriteEnabledCmd.html">00581</a> <font class="keyword">class </font><a class="code" href="classCSetDepthWriteEnabledCmd.html">CSetDepthWriteEnabledCmd</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00582       <font class="keywordtype">bool</font>      Enabled;
00583    <font class="keyword">public</font>:
<a name="l00584"></a><a class="code" href="classCSetDepthWriteEnabledCmd.html#a0">00584</a>       <a class="code" href="classCSetDepthWriteEnabledCmd.html#a0">CSetDepthWriteEnabledCmd</a>( <font class="keywordtype">bool</font> enabled ) : Enabled(enabled) {}
<a name="l00585"></a><a class="code" href="classCSetDepthWriteEnabledCmd.html#a1">00585</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00586          pGLContext-&gt;GetImmDrawContext().SetDepthWriteEnabled(Enabled);
00587          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00588       }
00589 };
00590 
00591 <font class="keywordtype">void</font>
<a name="l00592"></a><a class="code" href="classCDListDrawContext.html#a11">00592</a> <a class="code" href="classCDListDrawContext.html#a11">CDListDrawContext::SetDepthWriteEnabled</a>( <font class="keywordtype">bool</font> enabled )<font class="keyword"></font>
00593 {
00594    GLContext.GetDListGeomManager().Flush();
00595 
00596    GLContext.GetDListManager().GetOpenDList() += CSetDepthWriteEnabledCmd(enabled);
00597    GLContext.DepthWriteEnabledChanged();
00598 }
00599 
<a name="l00600"></a><a class="code" href="classCSetFrameBufferDrawMaskCmd.html">00600</a> <font class="keyword">class </font><a class="code" href="classCSetFrameBufferDrawMaskCmd.html">CSetFrameBufferDrawMaskCmd</a> : <font class="keyword">public</font> <a class="code" href="classCDListCmd.html">CDListCmd</a> {
00601       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>      Mask;
00602    <font class="keyword">public</font>:
<a name="l00603"></a><a class="code" href="classCSetFrameBufferDrawMaskCmd.html#a0">00603</a>       <a class="code" href="classCSetFrameBufferDrawMaskCmd.html#a0">CSetFrameBufferDrawMaskCmd</a>( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> mask ) : Mask(mask) {}
<a name="l00604"></a><a class="code" href="classCSetFrameBufferDrawMaskCmd.html#a1">00604</a>       <a class="code" href="classCDListCmd.html">CDListCmd</a>* <a class="code" href="classCDListCmd.html#a1">Play</a>()<font class="keyword"> </font>{
00605          pGLContext-&gt;GetImmDrawContext().SetFrameBufferDrawMask(Mask);
00606          <font class="keywordflow">return</font> <a class="code" href="classCDListCmd.html#d1">CDListCmd::GetNextCmd</a>(<font class="keyword">this</font>);
00607       }
00608 };
00609 
00610 <font class="keywordtype">void</font>
<a name="l00611"></a><a class="code" href="classCDListDrawContext.html#a12">00611</a> <a class="code" href="classCDListDrawContext.html#a12">CDListDrawContext::SetFrameBufferDrawMask</a>( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> mask )<font class="keyword"></font>
00612 {
00613    GLContext.GetDListGeomManager().Flush();
00614 
00615    GLContext.GetDListManager().GetOpenDList() += CSetFrameBufferDrawMaskCmd(mask);
00616    GLContext.FrameBufferDrawMaskChanged();  
00617 }
00618 
00619 <font class="comment">/********************************************</font>
00620  * gl api
00621  */
00622 
<a name="l00623"></a><a class="code" href="drawcontext_8cpp.html#a746">00623</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a746">glDepthFunc</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> func )<font class="keyword"></font>
00624 {
00625    <a class="code" href="debug_8h.html#a1">mNotImplemented</a>( );
00626 }
00627 
<a name="l00628"></a><a class="code" href="drawcontext_8cpp.html#a724">00628</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a724">glDrawBuffer</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> mode )<font class="keyword"></font>
00629 {
00630    <a class="code" href="debug_8h.html#a1">mNotImplemented</a>( );
00631 }
00632 
<a name="l00633"></a><a class="code" href="drawcontext_8cpp.html#a722">00633</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a722">glClipPlane</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> plane, <font class="keyword">const</font> <a class="code" href="gl_8h.html#a700">GLdouble</a> *equation )<font class="keyword"></font>
00634 {
00635    <a class="code" href="debug_8h.html#a1">mNotImplemented</a>( );
00636 }
00637 
00638 <font class="comment">// alpha blending</font>
00639 
<a name="l00640"></a><a class="code" href="drawcontext_8cpp.html#a708">00640</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a708">glBlendFunc</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> sfactor, <a class="code" href="gl_8h.html#a687">GLenum</a> dfactor )<font class="keyword"></font>
00641 {
00642    pGLContext-&gt;GetDrawContext().SetBlendMode( sfactor, dfactor );
00643 }
00644 
00645 <font class="comment">// alpha test</font>
00646 
<a name="l00647"></a><a class="code" href="drawcontext_8cpp.html#a707">00647</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a707">glAlphaFunc</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> func, <a class="code" href="gl_8h.html#a699">GLclampf</a> ref )<font class="keyword"></font>
00648 {
00649    pGLContext-&gt;GetDrawContext().SetAlphaFunc( func, ref );
00650 }
00651 
00652 <font class="comment">// depth test</font>
00653 
<a name="l00654"></a><a class="code" href="drawcontext_8cpp.html#a747">00654</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a747">glDepthMask</a>( <a class="code" href="gl_8h.html#a688">GLboolean</a> enabled )<font class="keyword"></font>
00655 {
00656    <a class="code" href="classCImmDrawContext.html">CImmDrawContext</a> &amp;drawContext = pGLContext-&gt;GetImmDrawContext();
00657    drawContext.<a class="code" href="classCImmDrawContext.html#a26">SetDepthWriteEnabled</a>(enabled);
00658 }
00659 
<a name="l00660"></a><a class="code" href="drawcontext_8cpp.html#a929">00660</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a929">glShadeModel</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> mode )<font class="keyword"></font>
00661 {
00662    <a class="code" href="classCImmDrawContext.html">CImmDrawContext</a> &amp;drawContext = pGLContext-&gt;GetImmDrawContext();
00663    drawContext.<a class="code" href="classCImmDrawContext.html#a14">SetDoSmoothShading</a>( (mode == <a class="code" href="gl_8h.html#a146">GL_FLAT</a>) ? <font class="keyword">false</font> : <font class="keyword">true</font> );
00664 }
00665 
<a name="l00666"></a><a class="code" href="drawcontext_8cpp.html#a710">00666</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a710">glCullFace</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> mode )<font class="keyword"></font>
00667 {
00668    mWarnIf( mode == <a class="code" href="gl_8h.html#a144">GL_FRONT_AND_BACK</a>, <font class="stringliteral">"GL_FRONT_AND_BACK culling is not supported"</font> );
00669    <a class="code" href="classCImmDrawContext.html">CImmDrawContext</a> &amp;drawContext = pGLContext-&gt;GetImmDrawContext();
00670    drawContext.<a class="code" href="classCImmDrawContext.html#a20">SetCullFaceDir</a>( (mode == <a class="code" href="gl_8h.html#a84">GL_FRONT</a>) ? 1 : -1 );
00671 }
00672 
<a name="l00673"></a><a class="code" href="drawcontext_8cpp.html#a706">00673</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a706">glColorMask</a>( <a class="code" href="gl_8h.html#a688">GLboolean</a> r_enabled, <a class="code" href="gl_8h.html#a688">GLboolean</a> g_enabled, 
00674                   <a class="code" href="gl_8h.html#a688">GLboolean</a> b_enabled, <a class="code" href="gl_8h.html#a688">GLboolean</a> a_enabled)<font class="keyword"></font>
00675 {
00676    <a class="code" href="classCImmDrawContext.html">CImmDrawContext</a> &amp;drawContext = pGLContext-&gt;GetImmDrawContext();
00677    <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> mask=0;
00678    <font class="keywordflow">if</font> (r_enabled==<a class="code" href="gl_8h.html#a1">GL_FALSE</a>) mask|=0xff;
00679    <font class="keywordflow">if</font> (g_enabled==<a class="code" href="gl_8h.html#a1">GL_FALSE</a>) mask|=0xff00;
00680    <font class="keywordflow">if</font> (b_enabled==<a class="code" href="gl_8h.html#a1">GL_FALSE</a>) mask|=0xff0000;
00681    <font class="keywordflow">if</font> (a_enabled==<a class="code" href="gl_8h.html#a1">GL_FALSE</a>) mask|=0xff000000;
00682    drawContext.<a class="code" href="classCImmDrawContext.html#a27">SetFrameBufferDrawMask</a>(mask);
00683 }
00684 
<a name="l00685"></a><a class="code" href="drawcontext_8cpp.html#a10">00685</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a721">glScissor</a>( <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, <font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height )<font class="keyword"></font>
00686 {
00687    <a class="code" href="debug_8h.html#a1">mNotImplemented</a>( );
00688 }
00689 
<a name="l00690"></a><a class="code" href="drawcontext_8cpp.html#a11">00690</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a749">glClearAccum</a>( <font class="keywordtype">float</font> red, <font class="keywordtype">float</font> green, <font class="keywordtype">float</font> blue, <font class="keywordtype">float</font> alpha )<font class="keyword"></font>
00691 {
00692    <a class="code" href="debug_8h.html#a1">mNotImplemented</a>( );
00693 }
00694 
<a name="l00695"></a><a class="code" href="drawcontext_8cpp.html#a12">00695</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a965">glClearStencil</a>( <font class="keywordtype">int</font> s )<font class="keyword"></font>
00696 {
00697    <a class="code" href="debug_8h.html#a1">mNotImplemented</a>( );
00698 }
00699 
<a name="l00700"></a><a class="code" href="drawcontext_8cpp.html#a715">00700</a> <font class="keywordtype">void</font> <a class="code" href="gl_8h.html#a715">glPolygonMode</a>( <a class="code" href="gl_8h.html#a687">GLenum</a> <font class="comment">/*face*/</font>, <a class="code" href="gl_8h.html#a687">GLenum</a> mode )<font class="keyword"></font>
00701 {
00702    <a class="code" href="classCImmDrawContext.html">CImmDrawContext</a> &amp;drawContext = pGLContext-&gt;GetImmDrawContext();
00703    drawContext.<a class="code" href="classCImmDrawContext.html#a29">SetPolygonMode</a>(mode);
00704 }
00705 
00706 <font class="comment">/********************************************</font>
00707  * ps2gl api
00708  */
00709 
00723 <font class="keywordtype">void</font>
<a name="l00724"></a><a class="code" href="drawcontext_8cpp.html#a37">00724</a> <a class="code" href="ps2gl_8h.html#a37">pglSetDrawBuffers</a>( <font class="keywordtype">int</font> interlaced,
00725                    <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> frame0_mem, <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> frame1_mem,
00726                    <a class="code" href="ps2gl_8h.html#a12">pgl_area_handle_t</a> depth_mem )<font class="keyword"></font>
00727 {
00728    pGLContext-&gt;GetDrawContext().SetDrawBuffers( interlaced,
00729                                                 reinterpret_cast&lt;GS::CMemArea*&gt;(frame0_mem),
00730                                                 reinterpret_cast&lt;GS::CMemArea*&gt;(frame1_mem),
00731                                                 reinterpret_cast&lt;GS::CMemArea*&gt;(depth_mem) );
00732 }
00733 
00734 <font class="keywordtype">void</font>
<a name="l00735"></a><a class="code" href="drawcontext_8cpp.html#a54">00735</a> <a class="code" href="ps2gl_8h.html#a54">pglSetInterlacingOffset</a>( <font class="keywordtype">float</font> yPixels )<font class="keyword"></font>
00736 {
00737    pGLContext-&gt;GetDrawContext().SetInterlacingOffset(yPixels);
00738 }
00739  <font class="comment">// pgl_api</font>
</pre></div><hr><address><small>ps2gl version cvs</small></address>
